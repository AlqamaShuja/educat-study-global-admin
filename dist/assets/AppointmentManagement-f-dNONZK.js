import{j as e,B as m,r as c,L as xe}from"./index-D_0a8VZH.js";import{u as pe}from"./consultantStore-BUlIl15K.js";import{B as ae}from"./Badge-DnoA-fpa.js";import{C as P}from"./Card-BZSd9g6-.js";import{C as ee}from"./calendar-CFgP2NK7.js";import{U as ne}from"./user-Col8Dc6N.js";import{M as he}from"./mail-NeauaYI_.js";import{C as ge}from"./clock-CRKKHv1b.js";import{E as fe}from"./eye-D1zuo86m.js";import{S as le}from"./square-pen-DP2r3-IP.js";import{T as je}from"./trash-2-D-1SKTu4.js";import{V as J}from"./video-qm4RLfQ8.js";import{f as te}from"./format-CW8_DxCc.js";import{A as ye}from"./AppointmentCalendarView-f1qsYc6o.js";import{M as F}from"./Modal-C-TYXrEH.js";import{I as L}from"./Input-CvXmBRSW.js";import{P as be}from"./plus-DFJI7CJl.js";import{S as Ne}from"./search-WQZEDZzZ.js";import{F as ve}from"./funnel-WOOAs9vc.js";import{M as se}from"./map-pin-Dpsu6ttS.js";import"./createLucideIcon-QavIXzvy.js";import"./toDate-BKXxHYqX.js";import"./subMonths-Boxt7nVc.js";import"./chevron-right-CqWP2rwp.js";import"./isSameDay-MFaTNiDj.js";const we=({appointments:x=[],onView:p,onEdit:S,onDelete:M,onJoin:E,getStatusColor:O,getTypeIcon:g})=>x.length===0?e.jsx(P,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No appointments found"}),e.jsx("p",{className:"text-gray-500",children:"No appointments to display at the moment."})]})}):e.jsx(P,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(l=>{var C,h;const f=new Date(l.dateTime),A=g(l.type);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx(ne,{className:"h-6 w-6 text-gray-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((C=l.student)==null?void 0:C.name)||"N/A"}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),((h=l.student)==null?void 0:h.email)||"N/A"]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ee,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:te(f,"MMM dd, yyyy")}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(ge,{className:"h-3 w-3 mr-1"}),te(f,"HH:mm")]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900 capitalize",children:l.type.replace("_"," ")})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(ae,{className:O(l.status),children:l.status.replace("_"," ").toUpperCase()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(m,{size:"sm",variant:"outline",onClick:()=>p(l),title:"View Details",children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>S(l),title:"Edit Appointment",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>M(l.id),className:"text-red-600 hover:text-red-800 hover:bg-red-50",title:"Delete Appointment",children:e.jsx(je,{className:"h-4 w-4"})}),l.type==="virtual"&&l.status==="scheduled"&&e.jsxs(m,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>E(l),children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),"Join"]})]})})]},l.id)})})]})})}),u=(x,p="info")=>{console.log(`${p.toUpperCase()}: ${x}`),window.alert&&p==="error"?window.alert(x):console.log(`Notification: ${x}`)},Ke=()=>{var Z,G,K,Q,W;const{leads:x,appointments:p=[],fetchLeads:S,scheduleMeeting:M,updateAppointment:E,deleteAppointment:O,fetchAppointments:g,loading:l,error:f,clearError:A}=pe(),[C,h]=c.useState([]),[ie,k]=c.useState(!1),[re,b]=c.useState(!1),[oe,N]=c.useState(!1),[s,i]=c.useState(null),[T,$]=c.useState("table"),[r,U]=c.useState({status:"",type:"",search:"",dateRange:""}),[a,v]=c.useState({studentId:"",dateTime:"",type:"in_person",notes:""}),[j,D]=c.useState(!1),I=t=>{if(!t)return"";const n=new Date(t),d=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-d).toISOString().slice(0,16)},B=t=>t?new Date(t).toISOString():"";c.useEffect(()=>{S(),g().then(t=>{t&&t.length>0?h(t):H()}).catch(t=>{console.error("Failed to fetch appointments:",t),H()})},[S,g]),c.useEffect(()=>{f&&(console.error("Store error:",f),u(f,"error"),A())},[f,A]);const q=p.length>0?p:C,H=()=>{const t=[{id:"apt-1",studentId:"e3701205-af3b-46b5-b059-a8d1bc4ff3ba",student:{id:"e3701205-af3b-46b5-b059-a8d1bc4ff3ba",name:"John Doe",email:"john@example.com",phone:"+1234567890"},dateTime:new Date(Date.now()+864e5).toISOString(),type:"virtual",status:"scheduled",notes:"Initial consultation about study abroad programs",createdAt:new Date().toISOString()},{id:"apt-2",studentId:"student-2",student:{id:"student-2",name:"Jane Smith",email:"jane@example.com",phone:"+1234567891"},dateTime:new Date(Date.now()+1728e5).toISOString(),type:"in_person",status:"scheduled",notes:"Follow-up meeting to discuss application progress",createdAt:new Date().toISOString()},{id:"apt-3",studentId:"student-3",student:{id:"student-3",name:"Mike Johnson",email:"mike@example.com",phone:"+1234567892"},dateTime:new Date(Date.now()-864e5).toISOString(),type:"virtual",status:"completed",notes:"Discussed university options and requirements",createdAt:new Date().toISOString()}];h(t)},de=async()=>{var t;if(!a.studentId||!a.dateTime){u("Please fill in all required fields","error");return}D(!0);try{const n={dateTime:B(a.dateTime),type:a.type,notes:a.notes},d=await M(a.studentId,n);if(p.length===0){const o={id:`apt-${Date.now()}`,studentId:a.studentId,dateTime:n.dateTime,type:a.type,notes:a.notes,student:((t=x.find(y=>{var w;return((w=y.student)==null?void 0:w.id)===a.studentId}))==null?void 0:t.student)||{id:a.studentId,name:"Unknown Student",email:"N/A"},status:"scheduled",createdAt:new Date().toISOString()};h(y=>[o,...y])}u("Appointment scheduled successfully!","success"),k(!1),V(),g().catch(()=>{console.log("Using local appointments")})}catch(n){u("Failed to schedule appointment","error"),console.error("Schedule appointment error:",n)}finally{D(!1)}},ce=async()=>{if(s){D(!0);try{const t={dateTime:typeof s.dateTime=="string"&&s.dateTime.includes("T")&&!s.dateTime.includes("Z")?B(s.dateTime):s.dateTime,type:s.type,status:s.status,notes:s.notes};try{await E(s.id,t),u("Appointment updated successfully!","success")}catch(n){console.warn("API update failed, updating local state:",n),h(d=>d.map(o=>o.id===s.id?{...s,dateTime:t.dateTime}:o)),u("Appointment updated locally!","success")}b(!1),i(null),g().catch(()=>{console.log("Using local appointments")})}catch(t){u("Failed to update appointment","error"),console.error("Update appointment error:",t)}finally{D(!1)}}},me=async t=>{if(confirm("Are you sure you want to delete this appointment?"))try{try{await O(t),u("Appointment deleted successfully!","success")}catch(n){console.warn("API delete failed, updating local state:",n),h(d=>d.filter(o=>o.id!==t)),u("Appointment deleted locally!","success")}g().catch(()=>{console.log("Using local appointments")})}catch(n){u("Failed to delete appointment","error"),console.error("Delete appointment error:",n)}},V=()=>{v({studentId:"",dateTime:"",type:"in_person",notes:""})},_=t=>({scheduled:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800",no_show:"bg-gray-100 text-gray-800"})[t]||"bg-gray-100 text-gray-800",R=t=>t==="virtual"?J:se,z=q.filter(t=>{var y,w,X,Y;const n=!r.status||t.status===r.status,d=!r.type||t.type===r.type,o=!r.search||((w=(y=t.student)==null?void 0:y.name)==null?void 0:w.toLowerCase().includes(r.search.toLowerCase()))||((Y=(X=t.student)==null?void 0:X.email)==null?void 0:Y.toLowerCase().includes(r.search.toLowerCase()));return n&&d&&o}),ue=x.map(t=>{var n,d,o;return{id:((n=t.student)==null?void 0:n.id)||t.studentId,name:((d=t.student)==null?void 0:d.name)||"Unknown Student",email:((o=t.student)==null?void 0:o.email)||"N/A"}});return l&&q.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(xe,{size:"lg"})}):e.jsxs("div",{className:"space-y-6 p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Appointment Management"}),e.jsx("p",{className:"text-gray-600",children:"Schedule and manage student appointments"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex rounded-md shadow-sm",children:[e.jsx("button",{onClick:()=>$("table"),className:`px-4 py-2 text-sm font-medium border ${T==="table"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} rounded-l-md`,children:"Table View"}),e.jsx("button",{onClick:()=>$("calendar"),className:`px-4 py-2 text-sm font-medium border-t border-r border-b ${T==="calendar"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} rounded-r-md`,children:"Calendar View"})]}),e.jsxs(m,{onClick:()=>k(!0),children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Schedule Meeting"]})]})]}),e.jsx(P,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(L,{placeholder:"Search by student name or email...",value:r.search,onChange:t=>U({...r,search:t.target.value}),className:"pl-10"})]}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:r.status,onChange:t=>U({...r,status:t.target.value}),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"no_show",children:"No Show"})]}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:r.type,onChange:t=>U({...r,type:t.target.value}),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"in_person",children:"In Person"}),e.jsx("option",{value:"virtual",children:"Virtual"})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Total: ",z.length," appointments"]})]})}),T==="table"&&e.jsx(we,{appointments:z,onView:t=>{i(t),N(!0)},onEdit:t=>{i(t),b(!0)},onDelete:me,onJoin:t=>{console.log("Join meeting:",t)},getStatusColor:_,getTypeIcon:R}),T==="calendar"&&e.jsx(ye,{appointments:z,onAppointmentClick:t=>{i(t),N(!0)},getStatusColor:_,getTypeIcon:R}),e.jsx(F,{isOpen:ie,onClose:()=>{k(!1),V()},title:"Schedule New Appointment",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student *"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:a.studentId,onChange:t=>v({...a,studentId:t.target.value}),children:[e.jsx("option",{value:"",children:"Select a student..."}),ue.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.email,")"]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date & Time *"}),e.jsx(L,{type:"datetime-local",value:I(a.dateTime),onChange:t=>v({...a,dateTime:t.target.value}),min:I(new Date().toISOString())})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Type"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:a.type,onChange:t=>v({...a,type:t.target.value}),children:[e.jsx("option",{value:"in_person",children:"In Person"}),e.jsx("option",{value:"virtual",children:"Virtual"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",rows:3,value:a.notes,onChange:t=>v({...a,notes:t.target.value}),placeholder:"Enter appointment notes..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(m,{variant:"outline",onClick:()=>{k(!1),V()},disabled:j,children:"Cancel"}),e.jsx(m,{onClick:de,disabled:j||!a.studentId||!a.dateTime,children:j?"Scheduling...":"Schedule Appointment"})]})]})}),e.jsx(F,{isOpen:oe,onClose:()=>{N(!1),i(null)},title:"Appointment Details",size:"lg",children:s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:((Z=s.student)==null?void 0:Z.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:((G=s.student)==null?void 0:G.email)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("p",{className:"text-gray-900",children:((K=s.student)==null?void 0:K.phone)||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Appointment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date & Time"}),e.jsx("p",{className:"text-gray-900",children:new Date(s.dateTime).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),e.jsxs("div",{className:"flex items-center",children:[s.type==="virtual"?e.jsx(J,{className:"h-4 w-4 mr-2 text-blue-500"}):e.jsx(se,{className:"h-4 w-4 mr-2 text-green-500"}),e.jsx("span",{className:"capitalize",children:s.type.replace("_"," ")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx(ae,{className:_(s.status),children:s.status.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),e.jsx("p",{className:"text-gray-900",children:new Date(s.createdAt).toLocaleDateString()})]})]})]}),s.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:e.jsx("p",{className:"text-gray-900",children:s.notes})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(m,{variant:"outline",onClick:()=>{N(!1),i(s),b(!0)},children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx(m,{onClick:()=>{N(!1),i(null)},children:"Close"})]})]})}),e.jsx(F,{isOpen:re,onClose:()=>{b(!1),i(null)},title:"Edit Appointment",size:"lg",children:s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student"}),e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-md",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:((Q=s.student)==null?void 0:Q.name)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:((W=s.student)==null?void 0:W.email)||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date & Time"}),e.jsx(L,{type:"datetime-local",value:I(s.dateTime),onChange:t=>i({...s,dateTime:t.target.value}),min:I(new Date().toISOString())})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Type"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:s.type,onChange:t=>i({...s,type:t.target.value}),children:[e.jsx("option",{value:"in_person",children:"In Person"}),e.jsx("option",{value:"virtual",children:"Virtual"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:s.status,onChange:t=>i({...s,status:t.target.value}),children:[e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"no_show",children:"No Show"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",rows:3,value:s.notes||"",onChange:t=>i({...s,notes:t.target.value}),placeholder:"Enter appointment notes..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(m,{variant:"outline",onClick:()=>{b(!1),i(null)},disabled:j,children:"Cancel"}),e.jsx(m,{onClick:ce,disabled:j,children:j?"Updating...":"Update Appointment"})]})]})})]})};export{Ke as default};
