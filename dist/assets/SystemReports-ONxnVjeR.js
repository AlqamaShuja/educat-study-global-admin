import{R as S,o as ae,r as R,j as e,c as ge,B as re}from"./index-B8d-T4_g.js";import{C as L}from"./Card-BmdFGXxf.js";import{S as Q}from"./Select-B_IZ9S1v.js";import{I as se}from"./Input-DF3u4mg_.js";import{i as be,D as je,f as Ne,E as we,L as q,a as z,C as ke,A as Ae,b as M,c as H,h as Se,d as De,g as de,u as Oe,G as Pe,e as ne,j as _e,X as me,Y as ue,k as Ce,R as Re,l as Ee,T as Fe,m as Le,n as Te,B as Be,o as Y,p as J}from"./BarChart-0lgjmrDu.js";import{B as Ie}from"./Badge-C9Vyx7sP.js";import{I as Me}from"./info-BKXL812a.js";import{T as $}from"./trending-up-BLOyqiLr.js";import{c as fe}from"./createLucideIcon-Sm81qEul.js";import{i as $e}from"./findIndex-hltmrPjQ.js";import{a as We,u as Ke}from"./officeStore-ChrLIvn7.js";import{a as Z}from"./reportService-CwYIj9jA.js";import{D as Ue}from"./download-CtKPDFXf.js";import{F as ze}from"./funnel-QJZBTu5v.js";import{S as Ge}from"./search-v1ZxCjqm.js";import{F as X}from"./file-text-B6EFZNGF.js";import{C as Ve}from"./calendar-dTGyL5Lu.js";import{B as Qe}from"./book-open-DLxPyMrc.js";import{U as qe}from"./users-B4t-nxO4.js";import"./index-CV7X3Ves.js";import"./target-DnVFR7EA.js";import"./userService-fcNfPGgU.js";import"./officeService-pIKWPzAM.js";/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M5 12h14",key:"1ays0h"}]],Je=fe("minus",Ye);/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],He=fe("trending-down",Xe);var Ze=["type","layout","connectNulls","ref"],et=["key"];function T(t){"@babel/helpers - typeof";return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},T(t)}function ie(t,s){if(t==null)return{};var a=tt(t,s),r,n;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(n=0;n<c.length;n++)r=c[n],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function tt(t,s){if(t==null)return{};var a={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(s.indexOf(r)>=0)continue;a[r]=t[r]}return a}function W(){return W=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},W.apply(this,arguments)}function oe(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function P(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?oe(Object(a),!0).forEach(function(r){C(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function F(t){return nt(t)||st(t)||rt(t)||at()}function at(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rt(t,s){if(t){if(typeof t=="string")return ee(t,s);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ee(t,s)}}function st(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function nt(t){if(Array.isArray(t))return ee(t)}function ee(t,s){(s==null||s>t.length)&&(s=t.length);for(var a=0,r=new Array(s);a<s;a++)r[a]=t[a];return r}function it(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function le(t,s){for(var a=0;a<s.length;a++){var r=s[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,he(r.key),r)}}function ot(t,s,a){return s&&le(t.prototype,s),a&&le(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function lt(t,s,a){return s=G(s),ct(t,pe()?Reflect.construct(s,a||[],G(t).constructor):s.apply(t,a))}function ct(t,s){if(s&&(T(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dt(t)}function dt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pe=function(){return!!t})()}function G(t){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},G(t)}function mt(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&te(t,s)}function te(t,s){return te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},te(t,s)}function C(t,s,a){return s=he(s),s in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function he(t){var s=ut(t,"string");return T(s)=="symbol"?s:s+""}function ut(t,s){if(T(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(T(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var K=function(t){function s(){var a;it(this,s);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=lt(this,s,[].concat(n)),C(a,"state",{isAnimationFinished:!0,totalLength:0}),C(a,"generateSimpleStrokeDasharray",function(o,l){return"".concat(l,"px ").concat(o-l,"px")}),C(a,"getStrokeDasharray",function(o,l,m){var f=m.reduce(function(p,D){return p+D});if(!f)return a.generateSimpleStrokeDasharray(l,o);for(var j=Math.floor(o/f),h=o%f,x=l-o,N=[],d=0,y=0;d<m.length;y+=m[d],++d)if(y+m[d]>h){N=[].concat(F(m.slice(0,d)),[h-y]);break}var k=N.length%2===0?[0,x]:[x];return[].concat(F(s.repeat(m,j)),F(N),k).map(function(p){return"".concat(p,"px")}).join(", ")}),C(a,"id",Oe("recharts-line-")),C(a,"pathRef",function(o){a.mainCurve=o}),C(a,"handleAnimationEnd",function(){a.setState({isAnimationFinished:!0}),a.props.onAnimationEnd&&a.props.onAnimationEnd()}),C(a,"handleAnimationStart",function(){a.setState({isAnimationFinished:!1}),a.props.onAnimationStart&&a.props.onAnimationStart()}),a}return mt(s,t),ot(s,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,n){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,o=c.points,l=c.xAxis,m=c.yAxis,f=c.layout,j=c.children,h=Ne(j,we);if(!h)return null;var x=function(y,k){return{x:y.x,y:y.y,value:y.value,errorVal:de(y.payload,k)}},N={clipPath:r?"url(#clipPath-".concat(n,")"):null};return S.createElement(q,N,h.map(function(d){return S.cloneElement(d,{key:"bar-".concat(d.props.dataKey),data:o,xAxis:l,yAxis:m,layout:f,dataPointFormatter:x})}))}},{key:"renderDots",value:function(r,n,c){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var l=this.props,m=l.dot,f=l.points,j=l.dataKey,h=z(this.props,!1),x=z(m,!0),N=f.map(function(y,k){var p=P(P(P({key:"dot-".concat(k),r:3},h),x),{},{index:k,cx:y.x,cy:y.y,value:y.value,dataKey:j,payload:y.payload,points:f});return s.renderDotItem(m,p)}),d={clipPath:r?"url(#clipPath-".concat(n?"":"dots-").concat(c,")"):null};return S.createElement(q,W({className:"recharts-line-dots",key:"dots"},d),N)}},{key:"renderCurveStatically",value:function(r,n,c,o){var l=this.props,m=l.type,f=l.layout,j=l.connectNulls;l.ref;var h=ie(l,Ze),x=P(P(P({},z(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:n?"url(#clipPath-".concat(c,")"):null,points:r},o),{},{type:m,layout:f,connectNulls:j});return S.createElement(ke,W({},x,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,n){var c=this,o=this.props,l=o.points,m=o.strokeDasharray,f=o.isAnimationActive,j=o.animationBegin,h=o.animationDuration,x=o.animationEasing,N=o.animationId,d=o.animateNewValues,y=o.width,k=o.height,p=this.state,D=p.prevPoints,u=p.totalLength;return S.createElement(Ae,{begin:j,duration:h,isActive:f,easing:x,from:{t:0},to:{t:1},key:"line-".concat(N),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var g=b.t;if(D){var A=D.length/l.length,w=l.map(function(O,V){var B=Math.floor(V*A);if(D[B]){var I=D[B],E=M(I.x,O.x),xe=M(I.y,O.y);return P(P({},O),{},{x:E(g),y:xe(g)})}if(d){var ve=M(y*2,O.x),ye=M(k/2,O.y);return P(P({},O),{},{x:ve(g),y:ye(g)})}return P(P({},O),{},{x:O.x,y:O.y})});return c.renderCurveStatically(w,r,n)}var i=M(0,u),v=i(g),_;if(m){var U="".concat(m).split(/[,\s]+/gim).map(function(O){return parseFloat(O)});_=c.getStrokeDasharray(v,u,U)}else _=c.generateSimpleStrokeDasharray(u,v);return c.renderCurveStatically(l,r,n,{strokeDasharray:_})})}},{key:"renderCurve",value:function(r,n){var c=this.props,o=c.points,l=c.isAnimationActive,m=this.state,f=m.prevPoints,j=m.totalLength;return l&&o&&o.length&&(!f&&j>0||!$e(f,o))?this.renderCurveWithAnimation(r,n):this.renderCurveStatically(o,r,n)}},{key:"render",value:function(){var r,n=this.props,c=n.hide,o=n.dot,l=n.points,m=n.className,f=n.xAxis,j=n.yAxis,h=n.top,x=n.left,N=n.width,d=n.height,y=n.isAnimationActive,k=n.id;if(c||!l||!l.length)return null;var p=this.state.isAnimationFinished,D=l.length===1,u=ae("recharts-line",m),b=f&&f.allowDataOverflow,g=j&&j.allowDataOverflow,A=b||g,w=H(k)?this.id:k,i=(r=z(o,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},v=i.r,_=v===void 0?3:v,U=i.strokeWidth,O=U===void 0?2:U,V=Se(o)?o:{},B=V.clipDot,I=B===void 0?!0:B,E=_*2+O;return S.createElement(q,{className:u},b||g?S.createElement("defs",null,S.createElement("clipPath",{id:"clipPath-".concat(w)},S.createElement("rect",{x:b?x:x-N/2,y:g?h:h-d/2,width:b?N:N*2,height:g?d:d*2})),!I&&S.createElement("clipPath",{id:"clipPath-dots-".concat(w)},S.createElement("rect",{x:x-E/2,y:h-E/2,width:N+E,height:d+E}))):null,!D&&this.renderCurve(A,w),this.renderErrorBar(A,w),(D||o)&&this.renderDots(A,I,w),(!y||p)&&De.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:n.curPoints}:r.points!==n.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,n){for(var c=r.length%2!==0?[].concat(F(r),[0]):r,o=[],l=0;l<n;++l)o=[].concat(F(o),F(c));return o}},{key:"renderDotItem",value:function(r,n){var c;if(S.isValidElement(r))c=S.cloneElement(r,n);else if(be(r))c=r(n);else{var o=n.key,l=ie(n,et),m=ae("recharts-line-dot",typeof r!="boolean"?r.className:"");c=S.createElement(je,W({key:o},l,{className:m}))}return c}}])}(R.PureComponent);C(K,"displayName","Line");C(K,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Pe.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});C(K,"getComposedData",function(t){var s=t.props,a=t.xAxis,r=t.yAxis,n=t.xAxisTicks,c=t.yAxisTicks,o=t.dataKey,l=t.bandSize,m=t.displayedData,f=t.offset,j=s.layout,h=m.map(function(x,N){var d=de(x,o);return j==="horizontal"?{x:ne({axis:a,ticks:n,bandSize:l,entry:x,index:N}),y:H(d)?null:r.scale(d),value:d,payload:x}:{x:H(d)?null:a.scale(d),y:ne({axis:r,ticks:c,bandSize:l,entry:x,index:N}),value:d,payload:x}});return P({points:h,layout:j},f)});var ft=_e({chartName:"LineChart",GraphicalChild:K,axisComponents:[{axisType:"xAxis",AxisComp:me},{axisType:"yAxis",AxisComp:ue}],formatAxisMap:Ce});const ce=({data:t=[],title:s,subtitle:a,lines:r=[{dataKey:"value",stroke:"#3B82F6",name:"Value"}],xAxisKey:n="date",height:c=300,showGrid:o=!0,showLegend:l=!0,showTooltip:m=!0,showBrush:f=!1,showTrend:j=!0,formatValue:h=p=>p,formatXAxis:x=p=>p,referenceLines:N=[],className:d="",loading:y=!1,error:k=null})=>{const p=R.useMemo(()=>{if(!j||!t.length||!r.length)return null;const u=r[0],b=t.map(v=>v[u.dataKey]).filter(v=>v!=null);if(b.length<2)return null;const g=b[0],A=b[b.length-1],w=A-g,i=w/g*100;return{change:w,percentChange:i,trend:w>0?"up":w<0?"down":"flat",firstValue:g,lastValue:A}},[t,r,j]),D=({active:u,payload:b,label:g})=>!u||!b||!b.length?null:e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:x(g)}),b.map((A,w)=>e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:A.color}}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[A.name,":"]})]}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:h(A.value)})]},w))]});return y?e.jsx(L,{className:d,children:e.jsxs("div",{className:"p-6",children:[s&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-2 animate-pulse"}),a&&e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 animate-pulse"})]}),e.jsx("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]})}):k?e.jsx(L,{className:d,children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Me,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Failed to load chart data"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:k})]})})})}):!t||t.length===0?e.jsx(L,{className:d,children:e.jsxs("div",{className:"p-6",children:[s&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s}),a&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a})]}),e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx($,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No data available"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Data will appear here when available"})]})})]})}):e.jsx(L,{className:d,children:e.jsxs("div",{className:"p-6",children:[(s||p)&&e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[s&&e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s}),a&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a})]}),p&&e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:h(p.lastValue)}),e.jsxs("div",{className:"flex items-center space-x-1",children:[p.trend==="up"&&e.jsx($,{className:"h-4 w-4 text-green-500"}),p.trend==="down"&&e.jsx(He,{className:"h-4 w-4 text-red-500"}),p.trend==="flat"&&e.jsx(Je,{className:"h-4 w-4 text-gray-500"}),e.jsxs(Ie,{variant:p.trend==="up"?"success":p.trend==="down"?"destructive":"secondary",className:"text-xs",children:[p.percentChange>0?"+":"",p.percentChange.toFixed(1),"%"]})]})]})})]}),e.jsx("div",{style:{height:c},children:e.jsx(Re,{width:"100%",height:"100%",children:e.jsxs(ft,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[o&&e.jsx(Ee,{strokeDasharray:"3 3",className:"stroke-gray-200 dark:stroke-gray-700"}),e.jsx(me,{dataKey:n,tickFormatter:x,className:"text-gray-600 dark:text-gray-400",fontSize:12}),e.jsx(ue,{tickFormatter:h,className:"text-gray-600 dark:text-gray-400",fontSize:12}),m&&e.jsx(Fe,{content:e.jsx(D,{})}),l&&e.jsx(Le,{wrapperStyle:{color:"rgb(107 114 128)",fontSize:"14px"}}),N.map((u,b)=>e.jsx(Te,{y:u.value,stroke:u.color||"#EF4444",strokeDasharray:"5 5",label:u.label},b)),r.map((u,b)=>e.jsx(K,{type:"monotone",dataKey:u.dataKey,stroke:u.stroke,strokeWidth:u.strokeWidth||2,name:u.name,dot:u.showDots!==!1?{fill:u.stroke,strokeWidth:2,r:4}:!1,activeDot:u.showActiveDot!==!1?{r:6,fill:u.stroke,stroke:"#fff",strokeWidth:2}:!1,connectNulls:u.connectNulls!==!1},b)),f&&e.jsx(Be,{dataKey:n,height:30,stroke:"#3B82F6"})]})})}),r.length>1&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.map((u,b)=>{const g=t.map(i=>i[u.dataKey]).filter(i=>i!=null),A=g.length>0?g.reduce((i,v)=>i+v,0)/g.length:0,w=g.length>0?Math.max(...g):0;return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:u.stroke}}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u.name})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Avg: ",h(A)," | Max: ",h(w)]})]},b)})})})]})})},pt=ge(t=>({reports:[],loading:!1,fetchReports:async()=>{t({loading:!0});try{const s=await Z.getReports();t({reports:s})}finally{t({loading:!1})}},createReport:async s=>{const a=await Z.createReport(s);return t(r=>({reports:[...r.reports,a]})),a}})),It=()=>{var w;const[t,s]=R.useState(""),[a,r]=R.useState({startDate:"",endDate:"",officeId:"",staffId:""}),[n,c]=R.useState(null),[o,l]=R.useState(!1),[m,f]=R.useState(""),{offices:j,fetchOffices:h}=We(),{users:x,fetchAllStaff:N}=Ke(),{createReport:d}=pt(),y=[{value:"performance",label:"Performance Report"},{value:"lead",label:"Lead Report"},{value:"financial",label:"Financial Report"},{value:"staff_activity",label:"Staff Activity Report"},{value:"office_performance",label:"Office Performance Report"}];R.useEffect(()=>{h(),N()},[]);const k=j.map(i=>{var v;return{value:i.id,label:`${i.name} - ${(v=i.address)==null?void 0:v.city}`}}),p=x.map(i=>({value:i.id,label:`${i.name} (${i.role})`})),D=async()=>{if(!t){f("Please select a report type");return}l(!0),f("");try{const i=await d({type:t,parameters:{...a,dateRange:a.startDate&&a.endDate?{start:a.startDate,end:a.endDate}:void 0}}),v=u(t);c({...i,data:v.data,summary:v.summary})}catch(i){f(i.message||"Failed to fetch report data"),console.error("Error fetching report:",i)}finally{l(!1)}},u=i=>{switch(i){case"lead":return{data:[{month:"Jan",new:45,in_progress:32,converted:18,lost:12},{month:"Feb",new:52,in_progress:41,converted:22,lost:15},{month:"Mar",new:48,in_progress:38,converted:25,lost:10},{month:"Apr",new:61,in_progress:45,converted:28,lost:18},{month:"May",new:55,in_progress:42,converted:31,lost:14}],summary:[{label:"Total Leads",value:"261"},{label:"Conversion Rate",value:"24.5%"},{label:"Active Leads",value:"198"}]};case"office_performance":return{data:[{office:"Toronto",leads:45,appointments:32,conversions:18},{office:"Vancouver",leads:38,appointments:28,conversions:15},{office:"Montreal",leads:52,appointments:41,conversions:22}],summary:[{label:"Total Offices",value:"3"},{label:"Average Conversion",value:"18.3"},{label:"Top Performing",value:"Montreal"}]};case"staff_activity":return{data:[{week:"Week 1",tasks:24,leads:15,appointments:8},{week:"Week 2",tasks:31,leads:22,appointments:12},{week:"Week 3",tasks:28,leads:18,appointments:10},{week:"Week 4",tasks:35,leads:25,appointments:15}],summary:[{label:"Active Staff",value:"12"},{label:"Avg Tasks/Week",value:"29.5"},{label:"Efficiency Rate",value:"87%"}]};case"performance":return{data:[{metric:"Q1",efficiency:85,satisfaction:92,conversion:78},{metric:"Q2",efficiency:88,satisfaction:89,conversion:82},{metric:"Q3",efficiency:91,satisfaction:94,conversion:85}],summary:[{label:"Overall Score",value:"88.2%"},{label:"Best Quarter",value:"Q3"},{label:"Improvement",value:"+7.1%"}]};case"financial":return{data:[{month:"Jan",revenue:45e3,expenses:32e3,profit:13e3},{month:"Feb",revenue:52e3,expenses:35e3,profit:17e3},{month:"Mar",revenue:48e3,expenses:33e3,profit:15e3}],summary:[{label:"Total Revenue",value:"$145,000"},{label:"Profit Margin",value:"30.7%"},{label:"Growth Rate",value:"+12.5%"}]};default:return{data:[],summary:[]}}},b=async()=>{if(!t||!n){f("No report data available to download");return}try{const i=await Z.exportReport(n.id),v=window.URL.createObjectURL(i),_=document.createElement("a");_.href=v,_.setAttribute("download",`${t}_report_${new Date().toISOString().split("T")[0]}.pdf`),document.body.appendChild(_),_.click(),_.remove(),window.URL.revokeObjectURL(v)}catch(i){f(i.message||"Failed to download report"),console.error("Error downloading report:",i)}},g=()=>{if(!(n!=null&&n.data))return null;switch(t){case"lead":return e.jsx(J,{data:n.data,keys:["new","in_progress","converted","lost"],colors:["#3B82F6","#FBBF24","#10B981","#EF4444"],height:400,title:"Lead Conversion Funnel"});case"office_performance":return e.jsx(J,{data:n.data,keys:["leads","appointments","conversions"],colors:["#3B82F6","#10B981","#6366F1"],height:400,title:"Office Performance Metrics"});case"staff_activity":return e.jsx(ce,{data:n.data,keys:["tasks","leads","appointments"],colors:["#3B82F6","#10B981","#FBBF24"],height:400,title:"Staff Activity Trends"});case"performance":return e.jsx(J,{data:n.data,keys:["efficiency","satisfaction","conversion"],colors:["#3B82F6","#10B981","#6366F1"],height:400,title:"Overall Performance Metrics"});case"financial":return e.jsx(ce,{data:n.data,keys:["revenue","expenses","profit"],colors:["#10B981","#EF4444","#3B82F6"],height:400,title:"Financial Overview"});default:return null}},A=i=>{switch(i){case"lead":return e.jsx(qe,{className:"h-5 w-5"});case"office_performance":return e.jsx($,{className:"h-5 w-5"});case"staff_activity":return e.jsx(Y,{className:"h-5 w-5"});case"performance":return e.jsx($,{className:"h-5 w-5"});case"financial":return e.jsx(Qe,{className:"h-5 w-5"});default:return e.jsx(X,{className:"h-5 w-5"})}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Y,{className:"h-7 w-7 text-blue-600"}),"System Reports"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Generate and analyze comprehensive system reports with advanced filtering"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-3",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Available Reports"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.length})]}),e.jsxs(re,{onClick:b,disabled:!n||o,className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Download Report"]})]})]}),m&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:m}),e.jsxs(L,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5 text-gray-600"}),"Report Configuration"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Report Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{options:y,value:y.find(i=>i.value===t),onChange:i=>s((i==null?void 0:i.value)||""),placeholder:"Select Report Type",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx(se,{type:"date",value:a.startDate,onChange:i=>r({...a,startDate:i.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx(se,{type:"date",value:a.endDate,onChange:i=>r({...a,endDate:i.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Office Filter"}),e.jsx(Q,{options:[{value:"",label:"All Offices"},...k],value:k.find(i=>i.value===a.officeId)||{value:"",label:"All Offices"},onChange:i=>r({...a,officeId:(i==null?void 0:i.value)||""}),placeholder:"Select Office"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Staff Filter"}),e.jsx(Q,{options:[{value:"",label:"All Staff"},...p],value:p.find(i=>i.value===a.staffId)||{value:"",label:"All Staff"},onChange:i=>r({...a,staffId:(i==null?void 0:i.value)||""}),placeholder:"Select Staff"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-gray-500",children:t&&e.jsxs("div",{className:"flex items-center gap-2",children:[A(t),e.jsxs("span",{children:["Selected:"," ",(w=y.find(i=>i.value===t))==null?void 0:w.label]})]})}),e.jsxs(re,{onClick:D,disabled:!t||o,loading:o,className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Generate Report"]})]})]}),e.jsxs(L,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-gray-600"}),"Report Results"]}),o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:g()}),n.summary&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx($,{className:"h-5 w-5 text-blue-600"})}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Key Metrics"})]}),e.jsx("div",{className:"space-y-2",children:n.summary.slice(0,3).map((i,v)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[i.label,":"]}),e.jsx("span",{className:"font-medium text-gray-900",children:i.value})]},v))})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Y,{className:"h-5 w-5 text-green-600"})}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Performance"})]}),e.jsx("div",{className:"space-y-2",children:n.summary.slice(3,6).map((i,v)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[i.label,":"]}),e.jsx("span",{className:"font-medium text-gray-900",children:i.value})]},v))})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Ve,{className:"h-5 w-5 text-purple-600"})}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Period Info"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"From:"}),e.jsx("span",{className:"font-medium text-gray-900",children:a.startDate||"All time"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"To:"}),e.jsx("span",{className:"font-medium text-gray-900",children:a.endDate||"Present"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Generated:"}),e.jsx("span",{className:"font-medium text-gray-900",children:new Date().toLocaleDateString()})]})]})]})]}),n.details&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Report Details"}),e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:n.details})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(X,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Report Generated"}),e.jsx("p",{className:"text-gray-600",children:"Select a report type and configure filters to generate a comprehensive report."})]})]})]})};export{It as default};
