import{j as e,B as h,u as K,r as d}from"./index-D_0a8VZH.js";import{I as m}from"./Input-CvXmBRSW.js";import{M as Q}from"./Modal-C-TYXrEH.js";import{u as W,a as X}from"./officeStore-DmV9iHxf.js";import{U as R}from"./users-8DbqKR1r.js";import{P as Y}from"./plus-DFJI7CJl.js";import{S as Z}from"./search-WQZEDZzZ.js";import{F as M}from"./funnel-WOOAs9vc.js";import{E}from"./eye-D1zuo86m.js";import{P as D}from"./pen-CIFMM9gF.js";import"./userService-CYy00l9J.js";import"./officeService-CJb98nQG.js";import"./createLucideIcon-QavIXzvy.js";const ee=({isOpen:b,onClose:g,onSubmit:f,title:r,formData:n,setFormData:c,formErrors:a,offices:o})=>e.jsx(Q,{isOpen:b,onClose:g,title:r,size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[a.general&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:a.general}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Full Name *"}),e.jsx(m,{value:n.name,onChange:l=>c(t=>({...t,name:l.target.value})),placeholder:"John Doe",className:a.name?"border-red-500":"",required:!0,autoComplete:"new-name"}),a.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email *"}),e.jsx(m,{type:"email",value:n.email,onChange:l=>c(t=>({...t,email:l.target.value})),placeholder:"john@example.com",className:a.email?"border-red-500":"",required:!0,autoComplete:"new-email",name:"staff-email-field"}),a.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),e.jsx(m,{value:n.phone,onChange:l=>c(t=>({...t,phone:l.target.value})),placeholder:"+1-234-567-8900",className:a.phone?"border-red-500":"",autoComplete:"new-phone",name:"staff-phone-field"}),a.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:r.includes("Create")?"Password *":"New Password (Optional)"}),e.jsx(m,{type:"password",value:n.password,onChange:l=>c(t=>({...t,password:l.target.value})),placeholder:r.includes("Create")?"Enter password":"Leave blank to keep current",className:a.password?"border-red-500":"",required:r.includes("Create"),autoComplete:"new-password",name:"staff-password-field"}),a.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.password})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium border-b pb-2",children:"Role & Assignment"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Role *"}),e.jsxs("select",{value:n.role,onChange:l=>c(t=>({...t,role:l.target.value,officeId:l.target.value==="super_admin"?"":t.officeId})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${a.role?"border-red-500":"border-gray-300"}`,required:!0,children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"super_admin",children:"Super Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"consultant",children:"Consultant"}),e.jsx("option",{value:"receptionist",children:"Receptionist"})]}),a.role&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Office Assignment"}),e.jsxs("select",{value:n.officeId,onChange:l=>c(t=>({...t,officeId:l.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${a.officeId?"border-red-500":"border-gray-300"}`,disabled:n.role==="super_admin",children:[e.jsx("option",{value:"",children:"No Office Assignment"}),o==null?void 0:o.map(l=>{var t;return e.jsxs("option",{value:l.id,children:[l.name," - ",(t=l.address)==null?void 0:t.city]},l.id)})]}),a.officeId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.officeId}),n.role==="super_admin"&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Super admins are not assigned to specific offices"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status *"}),e.jsxs("select",{value:n.status,onChange:l=>c(t=>({...t,status:l.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${a.status?"border-red-500":"border-gray-300"}`,required:!0,children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"suspended",children:"Suspended"})]}),a.status&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.status}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Set the approval status for this staff member"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.isActive,onChange:l=>c(t=>({...t,isActive:l.target.checked})),className:"rounded"}),"Active Staff Member"]})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(h,{variant:"outline",onClick:g,children:"Cancel"}),e.jsx(h,{onClick:f,disabled:!n.name||!n.email||!n.role||!n.status||r.includes("Create")&&!n.password,children:r.includes("Create")?"Create Staff":"Update Staff"})]})]})}),Ne=()=>{const b=K(),[g,f]=d.useState(!1),[r,n]=d.useState(null),[c,a]=d.useState({}),[o,l]=d.useState(""),[t,P]=d.useState(""),[j,F]=d.useState(""),[v,L]=d.useState(""),[u,y]=d.useState({name:"",email:"",phone:"",password:"",role:"",officeId:"",isActive:!0,status:"pending"}),{users:$,isLoading:U,error:se,fetchAllStaff:S,createStaff:_,updateStaff:q,deleteStaff:ae,toggleStaffStatus:te,importStaffCSV:le,getStaffLogs:ne,bulkUpdateStaff:ie}=W(),{offices:N,fetchOffices:B}=X();console.log(N,"acnascjasnjncasncs:offices"),d.useEffect(()=>{S(),B()},[]);const C=()=>{y({name:"",email:"",phone:"",password:"",role:"",officeId:"",isActive:!0,status:"pending"}),a({}),n(null)},k=(s=null)=>{s?(n(s),y({name:s.name||"",email:s.email||"",phone:s.phone||"",password:"",role:s.role||"",officeId:s.officeId||"",isActive:s.isActive!==!1,status:s.status||"pending"})):C(),f(!0)},A=()=>{f(!1),C()},z=s=>{b(`/super-admin/staff/details/${s.id}`,{state:{staff:s}})},T=async()=>{try{a({}),console.log(u,"asckasncsanscns"),u.officeId==""&&(u.officeId=null),r?await q(r.id,u):await _(u),await S(),A()}catch(s){a({general:s.message||"An error occurred. Please try again."})}},w=$.filter(s=>{var I,O;const i=((I=s.name)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))||((O=s.email)==null?void 0:O.toLowerCase().includes(o.toLowerCase())),x=!t||s.role===t,p=!j||s.officeId===j,H=!v||s.status===v;return i&&x&&p&&H}),V=s=>({super_admin:"bg-purple-100 text-purple-800",manager:"bg-blue-100 text-blue-800",consultant:"bg-green-100 text-green-800",receptionist:"bg-yellow-100 text-yellow-800"})[s]||"bg-gray-100 text-gray-800",G=s=>(console.log(s,"sacacannjnacscsansa"),{pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",suspended:"bg-orange-100 text-orange-800"}[s.toLowerCase()]||"bg-gray-100 text-gray-800"),J=s=>{var x;const i=N.find(p=>p.id===s);return i?`${i.name} - ${(x=i.address)==null?void 0:x.city}`:"No Office"};return U?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(R,{className:"h-7 w-7 text-blue-600"}),"Staff Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage staff members, roles, and office assignments across your organization"})]}),e.jsxs(h,{onClick:()=>k(),className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Add Staff Member"]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(m,{placeholder:"Search by name or email...",value:o,onChange:s=>l(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsxs("select",{value:t,onChange:s=>P(s.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none bg-white",children:[e.jsx("option",{value:"",children:"All Roles"}),e.jsx("option",{value:"super_admin",children:"Super Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"consultant",children:"Consultant"}),e.jsx("option",{value:"receptionist",children:"Receptionist"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsxs("select",{value:v,onChange:s=>L(s.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none bg-white",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]}),e.jsx("div",{children:e.jsxs("select",{value:j,onChange:s=>F(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none bg-white",children:[e.jsx("option",{value:"",children:"All Offices"}),N.map(s=>{var i;return e.jsxs("option",{value:s.id,children:[s.name," - ",(i=s.address)==null?void 0:i.city]},s.id)})]})})]})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Staff Members (",w.length,")"]})}),w.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(R,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No staff members found"}),e.jsx("p",{className:"text-gray-600",children:o||t||j||v?"Try adjusting your search criteria":"Get started by adding your first staff member"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Staff Member"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Office Assignment"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Active"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(s=>{var i,x;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email}),s.phone&&e.jsx("div",{className:"text-sm text-gray-500",children:s.phone})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${V(s.role)}`,children:(i=s.role)==null?void 0:i.replace("_"," ").replace(/\b\w/g,p=>p.toUpperCase())})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:J(s.officeId)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${G(s.status)}`,children:(x=s.status)==null?void 0:x.replace(/\b\w/g,p=>p.toUpperCase())})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{className:"flex items-center gap-1",children:s.isActive?e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-sm text-green-600",children:"Active"})}):e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-sm text-gray-500",children:"Inactive"})})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>z(s),className:"flex items-center gap-1",children:[e.jsx(E,{className:"h-3 w-3"}),"View"]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>k(s),className:"flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),"Edit"]})]})})]},s.id)})})]})})]}),e.jsx(ee,{isOpen:g,onClose:A,onSubmit:T,title:r?"Edit Staff Member":"Create New Staff Member",formData:u,setFormData:y,formErrors:c,offices:N})]})};export{Ne as default};
