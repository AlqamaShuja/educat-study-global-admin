import{r as c,j as e,f as Js,u as Gs,a as Xs,L as ns,B as u}from"./index-D_0a8VZH.js";import{u as Ys}from"./consultantStore-BUlIl15K.js";import{C as I}from"./Card-BZSd9g6-.js";import{B as M}from"./Badge-DnoA-fpa.js";import{M as H}from"./Modal-C-TYXrEH.js";import{I as $}from"./Input-CvXmBRSW.js";import{P as Ue}from"./plus-DFJI7CJl.js";import{S as Zs}from"./save-DmVXDgr0.js";import{C as ee}from"./circle-check-big-KsGiVaDX.js";import{c as Fe}from"./createLucideIcon-QavIXzvy.js";import{P as Ks}from"./pen-line-xtmbo2wX.js";import{T as Qs}from"./trash-2-D-1SKTu4.js";import{U as Ws}from"./user-Col8Dc6N.js";import{X as se}from"./x-DZDe4kcp.js";import{C as cs}from"./circle-alert-C7gzbhSX.js";import{M as et,S as st}from"./send-CCYXw5y1.js";import{F as ue}from"./file-text-C1gJtZnp.js";import{S as os}from"./square-check-big-m-Ggu3E7.js";import{U as ds}from"./upload-CCRy7_Ut.js";import{B as Me}from"./briefcase-CCsjQawY.js";import{M as tt}from"./mail-NeauaYI_.js";import{P as at}from"./phone-D-KHASr-.js";import{C as lt}from"./calendar-CFgP2NK7.js";import{M as rt}from"./map-pin-Dpsu6ttS.js";import{E as ms}from"./eye-D1zuo86m.js";import{S as xs}from"./square-pen-DP2r3-IP.js";import{P as it}from"./package-CXN5CRjV.js";import{C as hs}from"./clock-CRKKHv1b.js";import{D as us}from"./download-DBIASzt_.js";/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ps=Fe("circle",nt);/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ot=Fe("image",ct);/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],mt=Fe("list",dt),xt=({isOpen:o,onClose:f,title:b,size:p="lg",children:N})=>o?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsx("div",{className:`inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle ${p==="sm"?"sm:max-w-sm":p==="md"?"sm:max-w-md":p==="lg"?"sm:max-w-lg":p==="xl"?"sm:max-w-4xl":"sm:max-w-lg"} sm:w-full`,children:e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:b}),e.jsx("button",{onClick:f,className:"rounded-md text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:e.jsx(se,{className:"h-6 w-6"})})]}),N]})})]})}):null,z=({children:o,onClick:f,disabled:b,variant:p="primary",size:N="md",className:P="",...n})=>{const j="inline-flex items-center justify-center border border-transparent font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors",i={sm:"px-3 py-2 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},v={primary:"text-white bg-blue-600 hover:bg-blue-700 focus:ring-blue-500",outline:"text-gray-700 bg-white hover:bg-gray-50 border-gray-300 focus:ring-blue-500",danger:"text-white bg-red-600 hover:bg-red-700 focus:ring-red-500"};return e.jsx("button",{onClick:f,disabled:b,className:`${j} ${i[N]} ${v[p]} ${b?"opacity-50 cursor-not-allowed":""} ${P}`,...n,children:o})},pe=({type:o="text",value:f,onChange:b,placeholder:p,className:N="",...P})=>e.jsx("input",{type:o,value:f,onChange:b,placeholder:p,className:`block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${N}`,...P}),ht=({size:o="md",className:f=""})=>{const b={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return e.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 ${b[o]} ${f}`})},ut=({isOpen:o,onClose:f,onSubmit:b,existingChecklist:p=null,studentName:N,loading:P=!1})=>{const[n,j]=c.useState({title:"",description:"",dueDate:"",priority:"medium",items:[]}),[i,v]=c.useState({title:"",description:"",completed:!1,required:!0}),[d,y]=c.useState(-1),[S,ge]=c.useState(!1);c.useEffect(()=>{o&&(j(p?{title:p.title||"",description:p.description||"",dueDate:p.dueDate?new Date(p.dueDate).toISOString().slice(0,16):"",priority:p.priority||"medium",items:p.items||[]}:{title:"",description:"",dueDate:"",priority:"medium",items:[]}),v({title:"",description:"",completed:!1,required:!0}),y(-1))},[o,p]);const te=()=>{if(!i.title.trim())return;const a={id:Date.now().toString(),title:i.title.trim(),description:i.description.trim(),completed:i.completed,required:i.required,createdAt:new Date().toISOString()};j(m=>({...m,items:[...m.items,a]})),v({title:"",description:"",completed:!1,required:!0})},fe=a=>{j(m=>({...m,items:m.items.filter((Z,Ne)=>Ne!==a)}))},je=a=>{const m=n.items[a];v({title:m.title,description:m.description||"",completed:m.completed,required:m.required}),y(a)},ye=()=>{if(!i.title.trim())return;const a=[...n.items];a[d]={...a[d],title:i.title.trim(),description:i.description.trim(),completed:i.completed,required:i.required,updatedAt:new Date().toISOString()},j(m=>({...m,items:a})),v({title:"",description:"",completed:!1,required:!0}),y(-1)},J=()=>{v({title:"",description:"",completed:!1,required:!0}),y(-1)},G=a=>{const m=[...n.items];m[a]={...m[a],completed:!m[a].completed,completedAt:m[a].completed?null:new Date().toISOString()},j(Z=>({...Z,items:m}))},be=async()=>{let a=[...n.items];if(d>=0?a[d]={...a[d],...i,title:i.title.trim(),description:i.description.trim(),updatedAt:new Date().toISOString()}:i.title.trim()&&a.push({id:Date.now().toString(),...i,title:i.title.trim(),description:i.description.trim(),createdAt:new Date().toISOString()}),!n.title.trim()){alert("Checklist title is required");return}if(a.length===0){alert("Please add at least one item to the checklist");return}const m={...n,items:a};ge(!0);try{await b(m),X()}catch(Z){console.error("Error submitting checklist:",Z)}finally{ge(!1)}},X=()=>{j({title:"",description:"",dueDate:"",priority:"medium",items:[]}),v({title:"",description:"",completed:!1,required:!0}),y(-1),f()},ae=n.items.filter(a=>a.completed).length,L=n.items.length,Y=L>0?Math.round(ae/L*100):0;return e.jsx(xt,{isOpen:o,onClose:X,title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-6 w-6 text-blue-600"}),e.jsx("span",{children:p?"Edit Checklist":"Create New Checklist"}),N&&e.jsxs("span",{className:"text-sm text-gray-500",children:["for ",N]})]}),size:"xl",children:e.jsxs("div",{className:"space-y-6 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Checklist Title *"}),e.jsx(pe,{type:"text",value:n.title,onChange:a=>j({...n,title:a.target.value}),placeholder:"e.g., Document Collection Checklist",className:"w-full"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:n.description,onChange:a=>j({...n,description:a.target.value}),placeholder:"Brief description of the checklist...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),e.jsx(pe,{type:"datetime-local",value:n.dueDate,onChange:a=>j({...n,dueDate:a.target.value}),min:new Date().toISOString().slice(0,16),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority Level"}),e.jsxs("select",{value:n.priority,onChange:a=>j({...n,priority:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"low",children:"ðŸŸ¢ Low Priority"}),e.jsx("option",{value:"medium",children:"ðŸŸ¡ Medium Priority"}),e.jsx("option",{value:"high",children:"ðŸ”´ High Priority"})]})]})]}),L>0&&e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[ae,"/",L," completed (",Y,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${Y}%`}})})]})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(Ue,{className:"h-5 w-5 mr-2 text-blue-600"}),d>=0?"Edit Item":"Add New Item"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Title *"}),e.jsx(pe,{type:"text",value:i.title,onChange:a=>v({...i,title:a.target.value}),placeholder:"e.g., Submit passport copy",className:"w-full"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx(pe,{type:"text",value:i.description,onChange:a=>v({...i,description:a.target.value}),placeholder:"Additional details about this item...",className:"w-full"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:i.required,onChange:a=>v({...i,required:a.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Required"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:i.completed,onChange:a=>v({...i,completed:a.target.checked}),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Completed"})]})]})]}),e.jsx("div",{className:"flex space-x-3",children:d>=0?e.jsxs(e.Fragment,{children:[e.jsxs(z,{onClick:ye,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Save Changes"]}),e.jsx(z,{onClick:J,size:"sm",variant:"outline",children:"Cancel"})]}):e.jsxs(z,{onClick:te,size:"sm",disabled:!i.title.trim(),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Add Item"]})})]}),n.items.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(ee,{className:"h-5 w-5 mr-2 text-green-600"}),"Checklist Items (",n.items.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:n.items.map((a,m)=>e.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-lg transition-colors ${a.completed?"bg-green-50 border-green-200":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("button",{onClick:()=>G(m),className:"flex-shrink-0",children:a.completed?e.jsx(ee,{className:"h-5 w-5 text-green-600"}):e.jsx(ps,{className:"h-5 w-5 text-gray-400 hover:text-green-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-sm font-medium ${a.completed?"text-green-800 line-through":"text-gray-900"}`,children:a.title}),a.required&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Required"})]}),a.description&&e.jsx("p",{className:`text-xs mt-1 ${a.completed?"text-green-600":"text-gray-500"}`,children:a.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{size:"sm",variant:"outline",onClick:()=>je(m),children:e.jsx(Ks,{className:"h-4 w-4"})}),e.jsx(z,{size:"sm",variant:"outline",onClick:()=>fe(m),className:"text-red-600 border-red-300 hover:bg-red-50",children:e.jsx(Qs,{className:"h-4 w-4"})})]})]},a.id||m))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(Ws,{className:"h-4 w-4"}),e.jsxs("span",{children:["Creating for: ",N]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(z,{variant:"outline",onClick:X,disabled:S,children:"Cancel"}),e.jsx(z,{onClick:be,disabled:S||!n.title.trim()||n.items.length===0,className:"bg-blue-600 hover:bg-blue-700 text-white",children:S?e.jsxs(e.Fragment,{children:[e.jsx(ht,{size:"sm",className:"mr-2"}),p?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),p?"Update Checklist":"Create Checklist"]})})]})]})]})})},x=(o,f="info")=>{console.log(`${f.toUpperCase()}: ${o}`),window.alert&&f==="error"?window.alert(o):console.log(`Notification: ${o}`)},Vt=()=>{var qe,Be,Re,Ve,He,Je,Ge,Xe,Ye,Ze,Ke,Qe,We,es,ss,ts,as,ls,rs,is;const{studentId:o}=Js(),f=Gs(),b=Xs(),[p,N]=c.useState(!1),[P,n]=c.useState(null),[j,i]=c.useState([]);console.log(b,"ascnajcnas:locationState");const v=(qe=b==null?void 0:b.state)==null?void 0:qe.lead,{studentProfile:d,tasks:y,documents:S,proposals:ge,fetchStudentProfile:te,sendMessage:fe,createTask:je,uploadDocument:ye,fetchLeadTasks:J,fetchLeadDocuments:G,fetchProposalsByLead:be,createProposal:X,updateProposal:ae,deleteProposal:L,loading:Y,error:a,clearError:m,checklists:Z,createChecklist:Ne,fetchStudentChecklists:K,updateChecklist:gs,deleteChecklist:fs}=Ys();console.log(S,"sacnacnajcnasjcn");const[js,le]=c.useState(!1),[ys,re]=c.useState(!1),[bs,ie]=c.useState(!1),[Ns,O]=c.useState(!1),[vs,ve]=c.useState(!1),[ne,ce]=c.useState(""),[U,_]=c.useState([]),[E,Q]=c.useState([]),[T,q]=c.useState([]),[oe,B]=c.useState([]),[h,D]=c.useState(null),[de,R]=c.useState(!1),[g,C]=c.useState({title:"",description:"",proposedProgram:"",proposedUniversity:"",estimatedCost:"",timeline:"",expiresAt:"",details:{}}),[ws,we]=c.useState(!1),[w,Ce]=c.useState(null),[ke,$e]=c.useState([]),[Cs,Ee]=c.useState(!1),[k,F]=c.useState(!1),r=v,ks=["passport","cnic","transcript","test_score","degree","experience_letter","bank_statement","photo","other"];c.useEffect(()=>{if(!r){console.warn("No lead data provided, redirecting back"),f("/consultant/leads");return}o&&(console.log(`Fetching profile for studentId: ${o}`),te(o).then(s=>{console.log("Fetch profile completed:",s),Ee(!0)}).catch(s=>{console.error("Fetch profile failed:",s),Ee(!0)}),r.id&&(console.log(`Fetching tasks, documents, and proposals for leadId: ${r.id}`),J(r.id),G(r.id),Se()))},[o,r,te,J,G,f]),c.useEffect(()=>{o&&r&&K(o).then(s=>{console.log(s,"akncancasjcasjcnasn"),i((s==null?void 0:s.data)||[])}).catch(s=>{console.error("Error fetching checklists:",s),i([])})},[o,r,K]);const Se=async()=>{if(r!=null&&r.id)try{const s=await be(r.id);$e(s||[])}catch(s){console.error("Error fetching proposals:",s),$e([])}};c.useEffect(()=>{a&&(console.error("Store error:",a),x(a,"error"),m())},[a,m]);const Ss=async()=>{if(!ne.trim()){x("Message cannot be empty","error");return}F(!0);try{await fe(o,ne.trim()),x("Message sent successfully!","success"),ce(""),re(!1)}catch(s){x("Failed to send message","error"),console.error("Send message error:",s)}finally{F(!1)}},Ps=async()=>{if(!U.length){x("Task list cannot be empty","error");return}if(!(r!=null&&r.id)){x("No lead found for this student","error");return}if(U.filter(t=>!t.description.trim()||!t.dueDate).length>0){x("All tasks must have description and due date","error");return}F(!0);try{for(const t of U)await je(r.id,{description:t.description.trim(),dueDate:t.dueDate});x("Tasks created successfully!","success"),_([]),ie(!1),await J(r.id)}catch(t){x("Failed to create tasks","error"),console.error("Create tasks error:",t)}finally{F(!1)}},Ds=async()=>{if(!E.length){x("Please select at least one file","error");return}if(!(r!=null&&r.id)){x("No lead found for this student","error");return}if(E.length!==T.length){x("Please select a type for each document","error");return}if(T.some(t=>!t)){x("Please select a type for each document","error");return}F(!0);try{const t=new FormData;E.forEach(l=>{t.append("files",l)}),t.append("types",JSON.stringify(T)),t.append("notes",JSON.stringify(oe)),await ye(r.id,t),x("Documents uploaded successfully!","success"),Q([]),q([]),B([]),le(!1),await G(r.id)}catch(t){x("Failed to upload documents","error"),console.error("Upload documents error:",t)}finally{F(!1)}},As=async()=>{if(!g.title.trim()){x("Proposal title is required","error");return}if(!(r!=null&&r.id)){x("No lead found for this student","error");return}F(!0);try{const s={...g,estimatedCost:g.estimatedCost?parseFloat(g.estimatedCost):null,expiresAt:g.expiresAt?new Date(g.expiresAt).toISOString():null};de&&h?(await ae(h.id,s),x("Proposal updated successfully!","success")):(await X(r.id,s),x("Proposal created successfully!","success")),C({title:"",description:"",proposedProgram:"",proposedUniversity:"",estimatedCost:"",timeline:"",expiresAt:"",details:{}}),O(!1),R(!1),D(null),await Se()}catch(s){x("Failed to save proposal","error"),console.error("Proposal save error:",s)}finally{F(!1)}},Is=s=>{D(s),C({title:s.title||"",description:s.description||"",proposedProgram:s.proposedProgram||"",proposedUniversity:s.proposedUniversity||"",estimatedCost:s.estimatedCost?s.estimatedCost.toString():"",timeline:s.timeline||"",expiresAt:s.expiresAt?new Date(s.expiresAt).toISOString().slice(0,16):"",details:s.details||{}}),R(!0),O(!0)},Ms=s=>{D(s),ve(!0)},Us=async s=>{if(window.confirm("Are you sure you want to delete this proposal?"))try{await L(s),x("Proposal deleted successfully!","success"),await Se()}catch(t){x("Failed to delete proposal","error"),console.error("Delete proposal error:",t)}},Te=s=>({pending:"bg-yellow-100 text-yellow-800",sent:"bg-blue-100 text-blue-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",expired:"bg-gray-100 text-gray-800"})[s]||"bg-gray-100 text-gray-800",Fs=()=>{_([...U,{description:"",dueDate:""}])},ze=(s,t,l)=>{const xe=U.map((W,he)=>he===s?{...W,[t]:l}:W);_(xe)},$s=s=>{_(U.filter((t,l)=>l!==s))},Es=s=>{const t=Array.from(s.target.files);Q(t),q(new Array(t.length).fill("")),B(new Array(t.length).fill(""))},Ts=(s,t)=>{const l=[...T];l[s]=t,q(l)},zs=(s,t)=>{const l=[...oe];l[s]=t,B(l)},Ls=s=>{Q(E.filter((t,l)=>l!==s)),q(T.filter((t,l)=>l!==s)),B(oe.filter((t,l)=>l!==s))},me=s=>s.split(".").pop().toLowerCase(),Pe=s=>{const t=["photo","image"],l=["jpg","jpeg","png","gif","bmp","webp"];return t.includes(s.type.toLowerCase())||l.includes(me(s.filePath))},De=s=>s.type.toLowerCase().includes("pdf")||me(s.filePath)==="pdf",Os=s=>{const t=`http://44.204.177.187/api/v1/api/v1/file/documents/${s.id}`;if(Pe(s))Ce({...s,url:t}),we(!0);else if(De(s))window.open(t,"_blank");else{const l=document.createElement("a");l.href=t,l.download=`${s.type}_${s.id}.${me(s.filePath)}`,document.body.appendChild(l),l.click(),document.body.removeChild(l)}},_s=s=>Pe(s)?e.jsx(ot,{className:"h-4 w-4"}):De(s)?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(us,{className:"h-4 w-4"}),qs=async s=>{try{await Ne(o,s),x("Checklist created successfully!","success");const t=await K(o);i(t||[])}catch(t){x("Failed to create checklist","error"),console.error("Create checklist error:",t)}},Bs=s=>{n(s),N(!0)},Rs=async s=>{if(P)try{const t=await gs(P.id,s);console.log(t,"=ascmsancsacasnssss:res"),x("Checklist updated successfully!","success");const l=await K(o);i(l.data||[]),n(null)}catch(t){x("Failed to update checklist","error"),console.error("Update checklist error:",t)}},Vs=async s=>{if(window.confirm("Are you sure you want to delete this checklist?"))try{await fs(s),x("Checklist deleted successfully!","success");const t=await K(o);i(t||[])}catch(t){x("Failed to delete checklist","error"),console.error("Delete checklist error:",t)}};if(!Cs||Y&&!d)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ns,{size:"lg"})});if(!r)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx(cs,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No lead data available"}),e.jsx("p",{className:"text-gray-600",children:"Please navigate from the leads page to view student profile."}),e.jsx(u,{onClick:()=>f("/consultant/my-leads"),className:"mt-4",children:"Back to Leads"})]});if(!d)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx(cs,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Profile not found"}),e.jsx("p",{className:"text-gray-600",children:"The student profile could not be loaded."}),e.jsx(u,{onClick:()=>f("/consultant/my-leads"),className:"mt-4",children:"Back to Leads"})]});const Ae=r.student||{},A={name:Ae.name||((Be=d.personalInfo)!=null&&Be.fullName?`${d.personalInfo.fullName.firstName||""} ${d.personalInfo.fullName.lastName||""}`.trim():(Re=d.personalInfo)==null?void 0:Re.name)||"N/A",email:Ae.email||((Ve=d.personalInfo)==null?void 0:Ve.email)||"N/A",phone:Ae.phone||((He=d.personalInfo)==null?void 0:He.phone)||"N/A",dob:((Je=d.personalInfo)==null?void 0:Je.dateOfBirth)||null,nationality:((Ge=d.personalInfo)==null?void 0:Ge.residenceCountry)||((Xe=d.personalInfo)==null?void 0:Xe.nationality)||"N/A",gender:((Ye=d.personalInfo)==null?void 0:Ye.gender)||"N/A"},Le=d.educationalBackground?Object.entries(d.educationalBackground).filter(([s,t])=>t&&typeof t=="object").map(([s,t])=>({type:s,institution:t.board||t.institution||"N/A",degree:t.preEngineeringOrPreMedical||t.subjects||t.degree||"N/A",year:t.year||"N/A",score:t.scorePercentage||t.gpa||null})):[],V={destination:((Ze=r.studyPreferences)==null?void 0:Ze.destination)||((Ke=d.studyPreferences)==null?void 0:Ke.preferredCountry)||"N/A",level:((Qe=d.studyPreferences)==null?void 0:Qe.studyLevel)||"N/A",fields:(We=d.studyPreferences)!=null&&We.specialization?[d.studyPreferences.specialization]:((es=d.studyPreferences)==null?void 0:es.fields)||((ss=r.studyPreferences)!=null&&ss.fields?[r.studyPreferences.fields]:[]),budget:((ts=r.studyPreferences)==null?void 0:ts.budget)||((as=d.studyPreferences)==null?void 0:as.budget)||"N/A"},Ie=y&&y.length?y.every(s=>s.status==="completed")?"Completed":"In Progress":"Not Started",Oe=y&&y.length?y.filter(s=>s.status==="completed").length/y.length*100:0,_e=r!=null&&r.history?r.history.slice(-3).reverse().map(s=>({action:s.note||s.action||"Activity recorded",timestamp:new Date(s.timestamp).toLocaleString()})):[];return e.jsxs("div",{className:"p-6 space-y-6 bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Profile"}),e.jsxs("p",{className:"text-gray-600",children:["Manage ",A.name,"'s information and application progress"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs(M,{className:"bg-blue-100 text-blue-800",children:["Lead ID: ",r.id.slice(-8)]}),e.jsx(M,{className:r.status==="converted"?"bg-green-100 text-green-800":r.status==="in_progress"?"bg-yellow-100 text-yellow-800":r.status==="lost"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800",children:(ls=r.status)==null?void 0:ls.replace("_"," ").toUpperCase()}),e.jsx(M,{className:"bg-purple-100 text-purple-800",children:(rs=r.source)==null?void 0:rs.toUpperCase()})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(u,{variant:"outline",onClick:()=>re(!0),children:[e.jsx(et,{className:"h-4 w-4 mr-2"}),"Send Message"]}),e.jsxs(u,{variant:"outline",onClick:()=>ie(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Create Task"]}),e.jsxs(u,{variant:"outline",onClick:()=>{n(null),N(!0)},className:"bg-purple-50 border-purple-300 text-purple-700 hover:bg-purple-100",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Create Checklist"]}),e.jsxs(u,{onClick:()=>le(!0),children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Upload Documents"]}),e.jsxs(u,{onClick:()=>{R(!1),D(null),C({title:"",description:"",proposedProgram:"",proposedUniversity:"",estimatedCost:"",timeline:"",expiresAt:"",details:{}}),O(!0)},className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Create Proposal"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(I,{title:"Personal Information",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("p",{className:"text-gray-900",children:A.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(tt,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("p",{className:"text-gray-900",children:A.email})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(at,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("p",{className:"text-gray-900",children:A.phone})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(lt,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("p",{className:"text-gray-900",children:A.dob?new Date(A.dob).toLocaleDateString():"N/A"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nationality"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(rt,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("p",{className:"text-gray-900",children:A.nationality})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsx("p",{className:"text-gray-900 capitalize",children:A.gender})]})]})}),e.jsx(I,{title:"Educational Background",children:Le.length>0?e.jsx("div",{className:"space-y-4",children:Le.map((s,t)=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 capitalize",children:s.type.replace(/([A-Z])/g," $1").trim()}),e.jsx("p",{className:"text-gray-600",children:s.institution}),e.jsx("p",{className:"text-gray-600",children:s.degree}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Year: ",s.year]}),s.score&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Score: ",s.score,"%"]})]},t))}):e.jsx("p",{className:"text-gray-500",children:"No educational background available"})}),e.jsx(I,{title:"Study Preferences",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Destination"}),e.jsx("p",{className:"text-gray-900",children:V.destination})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Study Level"}),e.jsx("p",{className:"text-gray-900",children:V.level})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field of Study"}),e.jsx("p",{className:"text-gray-900",children:Array.isArray(V.fields)&&V.fields.length?V.fields.join(", "):"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget Range"}),e.jsx("p",{className:"text-gray-900",children:V.budget})]})]})}),e.jsx(I,{title:"Proposals",children:ke&&ke.length>0?e.jsx("div",{className:"space-y-4",children:ke.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[s.proposedProgram&&e.jsxs("span",{children:["ðŸ“š ",s.proposedProgram]}),s.proposedUniversity&&e.jsxs("span",{children:["ðŸ« ",s.proposedUniversity]}),s.estimatedCost&&e.jsxs("span",{children:["ðŸ’° $",s.estimatedCost.toLocaleString()]})]})]}),e.jsx("div",{className:"flex items-center space-x-2 ml-4",children:e.jsx(M,{className:Te(s.status),children:s.status.toUpperCase()})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["Created:"," ",new Date(s.createdAt).toLocaleDateString(),s.expiresAt&&e.jsxs("span",{className:"ml-2",children:["Expires:"," ",new Date(s.expiresAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{size:"sm",variant:"outline",onClick:()=>Ms(s),title:"View Details",children:e.jsx(ms,{className:"h-4 w-4"})}),e.jsx(u,{size:"sm",variant:"outline",onClick:()=>Is(s),title:"Edit Proposal",className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx(u,{size:"sm",variant:"outline",onClick:()=>Us(s.id),title:"Delete Proposal",className:"text-red-600 border-red-300 hover:bg-red-50",children:e.jsx(se,{className:"h-4 w-4"})})]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(it,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No proposals created yet"}),e.jsxs(u,{onClick:()=>{R(!1),D(null),C({title:"",description:"",proposedProgram:"",proposedUniversity:"",estimatedCost:"",timeline:"",expiresAt:"",details:{}}),O(!0)},className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Create First Proposal"]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{title:"Application Status",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status"}),e.jsx(M,{className:Ie==="Completed"?"bg-green-100 text-green-800":Ie==="In Progress"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:Ie})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(Oe),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Oe}%`}})})]})}),e.jsx(I,{title:"Application Tasks",children:y&&y.length?e.jsx("div",{className:"space-y-2",children:y.map(s=>e.jsxs("div",{className:"flex items-start space-x-2",children:[s.status==="completed"?e.jsx(ee,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}):e.jsx(ps,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:`text-sm ${s.status==="completed"?"text-gray-500 line-through":"text-gray-900"}`,children:s.description}),s.dueDate&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mt-1",children:[e.jsx(hs,{className:"h-3 w-3 mr-1"}),new Date(s.dueDate).toLocaleDateString()]})]})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No tasks available"})}),e.jsx(I,{title:"Recent Activity",children:_e.length?e.jsx("div",{className:"space-y-3",children:_e.map((s,t)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:s.action}),e.jsx("p",{className:"text-xs text-gray-500",children:s.timestamp})]})]},t))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No recent activity"})}),e.jsx(I,{title:"Documents",children:S&&S.length?e.jsx("div",{className:"space-y-2",children:S==null?void 0:S.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg group",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[_s(s),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm text-gray-900 capitalize block truncate",children:s.type.replace("_"," ")}),s.notes&&e.jsx("span",{className:"text-xs text-gray-500 block truncate",children:s.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:s.status==="approved"?"bg-green-100 text-green-800":s.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800",children:s.status}),e.jsx("button",{onClick:()=>Os(s),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:Pe(s)?"View Image":De(s)?"Open PDF":"Download File",children:e.jsx(ms,{className:"h-4 w-4"})})]})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No documents uploaded"})}),e.jsx(I,{title:"Student Checklists",children:j&&j.length>0?e.jsx("div",{className:"space-y-3",children:j.map(s=>{var W,he;const t=((W=s.items)==null?void 0:W.filter(Hs=>Hs.completed).length)||0,l=((he=s.items)==null?void 0:he.length)||0,xe=l>0?Math.round(t/l*100):0;return e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:s.title}),s.description&&e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[e.jsxs("span",{children:[t,"/",l," completed"]}),s.dueDate&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(hs,{className:"h-3 w-3 mr-1"}),new Date(s.dueDate).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex items-center space-x-1 ml-2",children:e.jsx(M,{className:s.priority==="high"?"bg-red-100 text-red-800":s.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",children:s.priority})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[xe,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${xe}%`}})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(M,{className:s.status==="completed"?"bg-green-100 text-green-800":s.status==="in_progress"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:s.status.replace("_"," ").toUpperCase()}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>Bs(s),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:"Edit checklist",children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Vs(s.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Delete checklist",children:e.jsx(se,{className:"h-4 w-4"})})]})]})]},s.id)})}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(mt,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 text-sm mb-3",children:"No checklists created yet"}),e.jsxs(u,{size:"sm",onClick:()=>{n(null),N(!0)},className:"bg-purple-600 hover:bg-purple-700 text-white",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Create First Checklist"]})]})}),e.jsx(ut,{isOpen:p,onClose:()=>{N(!1),n(null)},onSubmit:P?Rs:qs,existingChecklist:P,studentName:A.name,loading:Y}),e.jsx(H,{isOpen:ws,onClose:()=>{we(!1),Ce(null)},title:`${((is=w==null?void 0:w.type)==null?void 0:is.replace("_"," "))||"Document"}`,size:"lg",children:w&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-center",children:[e.jsx("img",{src:w.url,alt:w.type,className:"max-w-full max-h-96 object-contain rounded-lg shadow-lg",onError:s=>{s.target.style.display="none",s.target.nextSibling.style.display="block"}}),e.jsxs("div",{className:"hidden text-center text-gray-500",children:[e.jsx(ue,{className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"Unable to load image"})]})]}),w.notes&&e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Notes:"})," ",w.notes]})}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[e.jsxs("span",{children:["Uploaded:"," ",new Date(w.createdAt).toLocaleDateString()]}),e.jsxs("span",{className:"capitalize",children:["Status: ",w.status]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(u,{variant:"outline",onClick:()=>{const s=document.createElement("a");s.href=w.url,s.download=`${w.type}_${w.id}.${me(w.filePath)}`,document.body.appendChild(s),s.click(),document.body.removeChild(s)},children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Download"]}),e.jsx(u,{onClick:()=>{we(!1),Ce(null)},children:"Close"})]})]})})]})]}),e.jsx(H,{isOpen:ys,onClose:()=>{re(!1),ce("")},title:"Send Message to Student",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:ne,onChange:s=>ce(s.target.value),placeholder:"Enter your message...",rows:4,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(u,{variant:"outline",onClick:()=>{re(!1),ce("")},disabled:k,children:"Cancel"}),e.jsxs(u,{onClick:Ss,disabled:k||!ne.trim(),children:[e.jsx(st,{className:"h-4 w-4 mr-2"}),k?"Sending...":"Send Message"]})]})]})}),e.jsx(H,{isOpen:bs,onClose:()=>{ie(!1),_([])},title:"Create Tasks",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:U.map((s,t)=>e.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end",children:[e.jsxs("div",{className:"col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Description"}),e.jsx($,{type:"text",value:s.description,onChange:l=>ze(t,"description",l.target.value),placeholder:"Enter task description...",className:"w-full"})]}),e.jsxs("div",{className:"col-span-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),e.jsx($,{type:"datetime-local",value:s.dueDate,onChange:l=>ze(t,"dueDate",l.target.value),className:"w-full"})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(u,{variant:"outline",size:"sm",onClick:()=>$s(t),className:"w-full",children:e.jsx(se,{className:"h-4 w-4"})})})]},t))}),e.jsxs(u,{variant:"outline",onClick:Fs,className:"w-full",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Add Task"]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(u,{variant:"outline",onClick:()=>{ie(!1),_([])},disabled:k,children:"Cancel"}),e.jsx(u,{onClick:Ps,disabled:k||!U.length,children:k?"Creating...":"Create Tasks"})]})]})}),e.jsx(H,{isOpen:js,onClose:()=>{le(!1),Q([]),q([]),B([])},title:"Upload Documents",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Files"}),e.jsx("input",{type:"file",multiple:!0,onChange:Es,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"})]}),E.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Document Details"}),E.map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",(s.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx("button",{onClick:()=>Ls(t),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(se,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Document Type *"}),e.jsxs("select",{value:T[t]||"",onChange:l=>Ts(t,l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"Select type..."}),ks.map(l=>e.jsx("option",{value:l,children:l.replace("_"," ").toUpperCase()},l))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),e.jsx("input",{type:"text",value:oe[t]||"",onChange:l=>zs(t,l.target.value),placeholder:"Add notes...",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]})]},t))]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(u,{variant:"outline",onClick:()=>{le(!1),Q([]),q([]),B([])},disabled:k,children:"Cancel"}),e.jsxs(u,{onClick:Ds,disabled:k||!E.length||T.some(s=>!s),children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),k?"Uploading...":"Upload Documents"]})]})]})}),e.jsx(H,{isOpen:Ns,onClose:()=>{O(!1),R(!1),D(null),C({title:"",description:"",proposedProgram:"",proposedUniversity:"",estimatedCost:"",timeline:"",expiresAt:"",details:{}})},title:de?"Edit Proposal":"Create Proposal",size:"xl",children:e.jsxs("div",{className:"space-y-6 z-30",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proposal Title *"}),e.jsx($,{type:"text",value:g.title,onChange:s=>C({...g,title:s.target.value}),placeholder:"e.g., Study Program Proposal for Computer Science",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:g.description,onChange:s=>C({...g,description:s.target.value}),placeholder:"Detailed description of the proposal...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proposed Program"}),e.jsx($,{type:"text",value:g.proposedProgram,onChange:s=>C({...g,proposedProgram:s.target.value}),placeholder:"e.g., Bachelor of Computer Science"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proposed University"}),e.jsx($,{type:"text",value:g.proposedUniversity,onChange:s=>C({...g,proposedUniversity:s.target.value}),placeholder:"e.g., University of Toronto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Cost (USD)"}),e.jsx($,{type:"number",step:"0.01",value:g.estimatedCost,onChange:s=>C({...g,estimatedCost:s.target.value}),placeholder:"e.g., 45000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timeline"}),e.jsx($,{type:"text",value:g.timeline,onChange:s=>C({...g,timeline:s.target.value}),placeholder:"e.g., 4 years, 18 months"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proposal Expires On"}),e.jsx($,{type:"datetime-local",value:g.expiresAt,onChange:s=>C({...g,expiresAt:s.target.value}),min:new Date().toISOString().slice(0,16)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Leave blank for no expiration"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(u,{variant:"outline",onClick:()=>{O(!1),R(!1),D(null),C({title:"",description:"",proposedProgram:"",proposedUniversity:"",estimatedCost:"",timeline:"",expiresAt:"",details:{}})},disabled:k,children:"Cancel"}),e.jsx(u,{onClick:As,disabled:k||!g.title.trim(),className:"bg-green-600 hover:bg-green-700 text-white",children:k?e.jsxs(e.Fragment,{children:[e.jsx(ns,{size:"sm",className:"mr-2"}),de?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),de?"Update Proposal":"Create Proposal"]})})]})]})}),e.jsx(H,{isOpen:vs,onClose:()=>{ve(!1),D(null)},title:"Proposal Details",size:"lg",children:h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:h.title}),e.jsx(M,{className:Te(h.status),children:h.status.toUpperCase()})]}),h.description&&e.jsx("p",{className:"text-blue-700 mb-3",children:h.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[h.proposedProgram&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-700",children:"Program:"})," ",h.proposedProgram]}),h.proposedUniversity&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-700",children:"University:"})," ",h.proposedUniversity]}),h.estimatedCost&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-700",children:"Cost:"})," $",h.estimatedCost.toLocaleString()," USD"]}),h.timeline&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-700",children:"Timeline:"})," ",h.timeline]})]})]}),h.details&&Object.keys(h.details).length>0&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-3",children:"Additional Details"}),e.jsx("div",{className:"space-y-2",children:Object.entries(h.details).map(([s,t])=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[s,":"]})," ",e.jsx("span",{className:"text-gray-600",children:t})]},s))})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-3",children:"Proposal Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(h.createdAt).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Updated:"})," ",new Date(h.updatedAt).toLocaleString()]}),h.expiresAt&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Expires:"})," ",new Date(h.expiresAt).toLocaleString()]}),h.sentAt&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Sent:"})," ",new Date(h.sentAt).toLocaleString()]})]})]}),e.jsx("div",{className:"flex justify-end space-x-3",children:e.jsx(u,{onClick:()=>{ve(!1),D(null)},children:"Close"})})]})})]})};export{Vt as default};
