import{c as pe,r as v,j as e,B as j,L as je}from"./index-D_0a8VZH.js";import{a as se}from"./leadService-BGFHSqvN.js";import{u as be,a as ve}from"./officeStore-DmV9iHxf.js";import{C as ae}from"./Card-BZSd9g6-.js";import{I as C}from"./Input-CvXmBRSW.js";import{M as U}from"./Modal-C-TYXrEH.js";import{B as V}from"./Badge-DnoA-fpa.js";import{D as ye}from"./DataTable-DA-IZIQM.js";import{S as ne}from"./Select-DcciDOjL.js";import{P as p}from"./index-BwWA86vI.js";import{C as ke}from"./ConfirmDialog-ByF4UMsJ.js";import{U as le}from"./user-plus-DPPOuk1r.js";import{D as te}from"./download-DBIASzt_.js";import{c as Ne}from"./createLucideIcon-QavIXzvy.js";import{S as Ce}from"./search-WQZEDZzZ.js";import{E as we}from"./eye-D1zuo86m.js";import{C as Se}from"./circle-x-DnT5izIu.js";import{C as Le}from"./circle-check-big-KsGiVaDX.js";import{C as Ie}from"./clock-CRKKHv1b.js";import{C as De}from"./circle-alert-C7gzbhSX.js";import"./userService-CYy00l9J.js";import"./officeService-CJb98nQG.js";/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Me=Ne("rotate-ccw",Ae),Oe=pe(i=>({leads:[],loading:!1,fetchLeads:async()=>{i({loading:!0});try{const d=await se.getAllLeads();i({leads:d})}finally{i({loading:!1})}},reassignLead:async(d,w)=>{const S=await se.reassignLead(d,w);return i(D=>({leads:D.leads.map(M=>M.id===d?S:M)})),S}})),re=({filters:i=[],activeFilters:d={},onFilterChange:w,onClearFilters:S,showDateRange:D=!1,onDateRangeChange:M,className:T=""})=>{const[r,k]=v.useState({startDate:"",endDate:""}),c=(t,m)=>{w(t,m)},b=(t,m)=>{const o={...r,[t]:m};k(o),M&&M(o)},R=()=>{k({startDate:"",endDate:""}),S()},g=()=>{const t=Object.keys(d).some(o=>d[o]),m=r.startDate||r.endDate;return t||m};return e.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${T}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Filters"}),g()&&e.jsxs(j,{variant:"outline",size:"sm",onClick:R,className:"text-gray-600 hover:text-gray-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear All"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[i.map(t=>{var m;return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t.label}),t.type==="select"||!t.type?e.jsx(ne,{options:t.options||[],value:(m=t.options)==null?void 0:m.find(o=>o.value===d[t.key]),onChange:o=>c(t.key,(o==null?void 0:o.value)||""),placeholder:t.placeholder||`All ${t.label.toLowerCase()}`,className:"w-full"}):t.type==="text"?e.jsx(C,{type:"text",value:d[t.key]||"",onChange:o=>c(t.key,o.target.value),placeholder:t.placeholder||`Filter by ${t.label.toLowerCase()}`,className:"w-full"}):t.type==="number"?e.jsx(C,{type:"number",value:d[t.key]||"",onChange:o=>c(t.key,o.target.value),placeholder:t.placeholder||`Filter by ${t.label.toLowerCase()}`,className:"w-full"}):t.type==="date"?e.jsx(C,{type:"date",value:d[t.key]||"",onChange:o=>c(t.key,o.target.value),className:"w-full"}):null]},t.key)}),D&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx(C,{type:"date",value:r.startDate,onChange:t=>b("startDate",t.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx(C,{type:"date",value:r.endDate,onChange:t=>b("endDate",t.target.value),min:r.startDate,className:"w-full"})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("status","active"),className:`${d.status==="active"?"bg-blue-50 border-blue-200 text-blue-700":""}`,children:"Active Only"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("created","today"),className:`${d.created==="today"?"bg-blue-50 border-blue-200 text-blue-700":""}`,children:"Created Today"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("created","this_week"),className:`${d.created==="this_week"?"bg-blue-50 border-blue-200 text-blue-700":""}`,children:"This Week"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("created","this_month"),className:`${d.created==="this_month"?"bg-blue-50 border-blue-200 text-blue-700":""}`,children:"This Month"})]}),g()&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active filters:"}),Object.entries(d).map(([t,m])=>{var N;if(!m)return null;const o=i.find(A=>A.key===t),u=(N=o==null?void 0:o.options)==null?void 0:N.find(A=>A.value===m),O=(u==null?void 0:u.label)||m;return e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[o==null?void 0:o.label,": ",O,e.jsx("button",{onClick:()=>c(t,""),className:"ml-1.5 h-4 w-4 rounded-full inline-flex items-center justify-center text-blue-400 hover:bg-blue-200 hover:text-blue-500 focus:outline-none",children:e.jsx("svg",{className:"h-2 w-2",stroke:"currentColor",fill:"none",viewBox:"0 0 8 8",children:e.jsx("path",{strokeLinecap:"round",d:"m1 1 6 6m0-6-6 6"})})})]},t)}),r.startDate&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["From: ",new Date(r.startDate).toLocaleDateString(),e.jsx("button",{onClick:()=>b("startDate",""),className:"ml-1.5 h-4 w-4 rounded-full inline-flex items-center justify-center text-green-400 hover:bg-green-200 hover:text-green-500 focus:outline-none",children:e.jsx("svg",{className:"h-2 w-2",stroke:"currentColor",fill:"none",viewBox:"0 0 8 8",children:e.jsx("path",{strokeLinecap:"round",d:"m1 1 6 6m0-6-6 6"})})})]}),r.endDate&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["To: ",new Date(r.endDate).toLocaleDateString(),e.jsx("button",{onClick:()=>b("endDate",""),className:"ml-1.5 h-4 w-4 rounded-full inline-flex items-center justify-center text-green-400 hover:bg-green-200 hover:text-green-500 focus:outline-none",children:e.jsx("svg",{className:"h-2 w-2",stroke:"currentColor",fill:"none",viewBox:"0 0 8 8",children:e.jsx("path",{strokeLinecap:"round",d:"m1 1 6 6m0-6-6 6"})})})]})]})})]})};re.propTypes={filters:p.arrayOf(p.shape({key:p.string.isRequired,label:p.string.isRequired,type:p.oneOf(["select","text","number","date"]),options:p.arrayOf(p.shape({value:p.string,label:p.string})),placeholder:p.string})),activeFilters:p.object,onFilterChange:p.func.isRequired,onClearFilters:p.func.isRequired,showDateRange:p.bool,onDateRangeChange:p.func,className:p.string};const Be=({selectedItems:i=[],actions:d=[],onAction:w,onClearSelection:S,className:D=""})=>{var A,E,B,H,z,_,F,x,L,q,W;const[M,T]=v.useState(null),[r,k]=v.useState({open:!1,action:null,data:{}}),[c,b]=v.useState({open:!1,action:null});if(i.length===0)return null;const R=a=>{T(a),a.requiresConfirmation?b({open:!0,action:a}):a.requiresInput?k({open:!0,action:a,data:{}}):g(a)},g=(a,h={})=>{w&&w(a.key,i,h),T(null),k({open:!1,action:null,data:{}}),b({open:!1,action:null})},t=()=>{c.action&&g(c.action)},m=()=>{r.action&&o(r.action,r.data)&&g(r.action,r.data)},o=(a,h)=>a.inputs?a.inputs.every(n=>!(n.required&&(!h[n.key]||h[n.key].toString().trim()===""))):!0,u=(a,h)=>{k(n=>({...n,data:{...n.data,[a]:h}}))},O=a=>{const h={delete:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),approve:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),reject:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),assign:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),export:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),activate:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),deactivate:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"})}),send:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),edit:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),move:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})})};return a.icon||h[a.key]||h.edit},N=a=>{var h;switch(a.type){case"select":return e.jsx(ne,{options:a.options||[],value:(h=a.options)==null?void 0:h.find(n=>n.value===r.data[a.key]),onChange:n=>u(a.key,(n==null?void 0:n.value)||""),placeholder:a.placeholder||`Select ${a.label.toLowerCase()}`});case"textarea":return e.jsx("textarea",{value:r.data[a.key]||"",onChange:n=>u(a.key,n.target.value),placeholder:a.placeholder,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:a.rows||3});case"number":return e.jsx(C,{type:"number",value:r.data[a.key]||"",onChange:n=>u(a.key,n.target.value),placeholder:a.placeholder,min:a.min,max:a.max,step:a.step});case"date":return e.jsx(C,{type:"date",value:r.data[a.key]||"",onChange:n=>u(a.key,n.target.value),min:a.min,max:a.max});case"datetime-local":return e.jsx(C,{type:"datetime-local",value:r.data[a.key]||"",onChange:n=>u(a.key,n.target.value),min:a.min,max:a.max});default:return e.jsx(C,{type:a.type||"text",value:r.data[a.key]||"",onChange:n=>u(a.key,n.target.value),placeholder:a.placeholder})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`bg-blue-50 border border-blue-200 rounded-lg p-4 ${D}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(V,{variant:"primary",size:"md",children:[i.length," selected"]}),e.jsx("span",{className:"text-sm text-blue-700",children:i.length===1?"1 item selected":`${i.length} items selected`}),e.jsx("button",{onClick:S,className:"text-blue-600 hover:text-blue-800 text-sm underline",children:"Clear selection"})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:d.map(a=>e.jsxs(j,{variant:a.variant||"outline",size:"sm",onClick:()=>R(a),disabled:a.disabled&&a.disabled(i),className:a.className,children:[O(a),e.jsx("span",{className:"ml-1",children:a.label})]},a.key))})]})}),e.jsx(ke,{isOpen:c.open,onClose:()=>b({open:!1,action:null}),onConfirm:t,title:((A=c.action)==null?void 0:A.confirmTitle)||`Confirm ${(E=c.action)==null?void 0:E.label}`,message:((B=c.action)==null?void 0:B.confirmMessage)||`Are you sure you want to ${(z=(H=c.action)==null?void 0:H.label)==null?void 0:z.toLowerCase()} ${i.length} selected item${i.length!==1?"s":""}?`,confirmText:((_=c.action)==null?void 0:_.confirmText)||((F=c.action)==null?void 0:F.label)||"Confirm",cancelText:"Cancel",type:((x=c.action)==null?void 0:x.confirmType)||"warning"}),e.jsx(U,{isOpen:r.open,onClose:()=>k({open:!1,action:null,data:{}}),title:((L=r.action)==null?void 0:L.modalTitle)||`${(q=r.action)==null?void 0:q.label} - ${i.length} item${i.length!==1?"s":""}`,size:((W=r.action)==null?void 0:W.modalSize)||"md",children:r.action&&e.jsxs("div",{className:"space-y-4",children:[r.action.description&&e.jsx("p",{className:"text-sm text-gray-600",children:r.action.description}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Selected Items (",i.length,")"]}),e.jsx("div",{className:"max-h-32 overflow-y-auto",children:e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[i.slice(0,5).map((a,h)=>e.jsxs("li",{className:"truncate",children:["•"," ",a.name||a.title||a.email||a.id||`Item ${h+1}`]},h)),i.length>5&&e.jsxs("li",{className:"text-gray-500 italic",children:["... and ",i.length-5," more items"]})]})})]}),r.action.inputs&&e.jsx("div",{className:"space-y-4",children:r.action.inputs.map(a=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a.label,a.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),N(a),a.helpText&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.helpText})]},a.key))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(j,{variant:"outline",onClick:()=>k({open:!1,action:null,data:{}}),children:"Cancel"}),e.jsx(j,{variant:r.action.submitVariant||"primary",onClick:m,disabled:!o(r.action,r.data),children:r.action.submitText||r.action.label||"Apply"})]})]})})]})},as=()=>{var X,Y,J,K,Q,Z,ee;const{leads:i,isLoading:d,error:w,pagination:S,fetchAllLeads:D,reassignLead:M,assignLeadToConsultant:T,exportLeads:r,getLeadHistory:k,bulkAssignLeads:c}=Oe(),{users:b,fetchAllStaff:R}=be(),{offices:g,fetchAllOffices:t}=ve(),[m,o]=v.useState(""),[u,O]=v.useState([]),[N,A]=v.useState({status:"",source:"",officeId:"",consultantId:"",dateRange:"30"}),[E,B]=v.useState(!1),[H,z]=v.useState(!1),[_,F]=v.useState(!1),[x,L]=v.useState(null),[q,W]=v.useState([]),[a,h]=v.useState(!1),[n,y]=v.useState({consultantId:"",officeId:""});v.useEffect(()=>{P()},[N,m]);const P=async()=>{try{await Promise.all([D({search:m,...N,page:S.currentPage}),R(),t()])}catch(s){console.error("Failed to load data:",s)}},oe=s=>{o(s)},ie=(s,l)=>{A(f=>({...f,[s]:l}))},ce=async(s,l,f)=>{try{await T({leadId:s,consultantId:l,officeId:f}),B(!1),L(null),y({consultantId:"",officeId:""}),await P()}catch($){console.error("Failed to assign lead:",$)}},de=async()=>{try{await c({leadIds:u,consultantId:n.consultantId,officeId:n.officeId}),z(!1),O([]),y({consultantId:"",officeId:""}),await P()}catch(s){console.error("Failed to bulk assign leads:",s)}},me=async s=>{try{L(s);const l=await k(s.id);W(l),F(!0)}catch(l){console.error("Failed to fetch lead history:",l)}},G=async()=>{h(!0);try{await r({filters:N,search:m,format:"csv"})}catch(s){console.error("Failed to export leads:",s)}finally{h(!1)}},ue=s=>{const l={new:{color:"blue",icon:De},in_progress:{color:"yellow",icon:Ie},converted:{color:"green",icon:Le},lost:{color:"red",icon:Se}},f=l[s]||l.new,$=f.icon;return e.jsxs(V,{color:f.color,className:"flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"}),s==null?void 0:s.replace("_"," ")]})},xe=s=>{const l={walk_in:"purple",online:"blue",referral:"green"};return e.jsx(V,{color:l[s]||"gray",children:s==null?void 0:s.replace("_"," ")})},I=(b==null?void 0:b.filter(s=>s.role==="consultant"))||[];b!=null&&b.filter(s=>s.role==="manager");const he=[{key:"student.name",label:"Student Name",sortable:!0,render:s=>{var l,f;return e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((l=s.student)==null?void 0:l.name)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:(f=s.student)==null?void 0:f.email})]})}},{key:"status",label:"Status",sortable:!0,render:s=>ue(s.status)},{key:"source",label:"Source",sortable:!0,render:s=>xe(s.source)},{key:"office.name",label:"Office",sortable:!0,render:s=>{var l,f,$;return e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((l=s.office)==null?void 0:l.name)||"Unassigned"}),e.jsx("div",{className:"text-sm text-gray-500",children:($=(f=s.office)==null?void 0:f.address)==null?void 0:$.city})]})}},{key:"consultant.name",label:"Consultant",sortable:!0,render:s=>e.jsx("div",{children:s.consultant?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium",children:s.consultant.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.consultant.email})]}):e.jsx(V,{color:"gray",children:"Unassigned"})})},{key:"studyPreferences.destination",label:"Destination",render:s=>{var l;return((l=s.studyPreferences)==null?void 0:l.destination)||"N/A"}},{key:"createdAt",label:"Created",sortable:!0,render:s=>new Date(s.createdAt).toLocaleDateString()},{key:"actions",label:"Actions",render:s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>me(s),children:e.jsx(we,{className:"w-4 h-4"})}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{L(s),y({consultantId:s.assignedConsultant||"",officeId:s.officeId||""}),B(!0)},children:e.jsx(le,{className:"w-4 h-4"})})]})}],ge=[{key:"status",label:"Status",type:"select",options:[{value:"",label:"All Statuses"},{value:"new",label:"New"},{value:"in_progress",label:"In Progress"},{value:"converted",label:"Converted"},{value:"lost",label:"Lost"}]},{key:"source",label:"Source",type:"select",options:[{value:"",label:"All Sources"},{value:"walk_in",label:"Walk-in"},{value:"online",label:"Online"},{value:"referral",label:"Referral"}]},{key:"officeId",label:"Office",type:"select",options:[{value:"",label:"All Offices"},...(g==null?void 0:g.map(s=>({value:s.id,label:s.name})))||[]]},{key:"consultantId",label:"Consultant",type:"select",options:[{value:"",label:"All Consultants"},{value:"unassigned",label:"Unassigned"},...(I==null?void 0:I.map(s=>({value:s.id,label:s.name})))||[]]}],fe=[{label:"Assign to Consultant",action:()=>z(!0),icon:le,disabled:u.length===0},{label:"Export Selected",action:()=>G(),icon:te,disabled:u.length===0}];return d&&!(i!=null&&i.length)?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(je,{size:"lg"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Global Lead Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage and oversee all leads across the organization"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",onClick:G,disabled:a,children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),a?"Exporting...":"Export All"]}),e.jsxs(j,{onClick:()=>P(),children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsx(ae,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(C,{placeholder:"Search by student name, email, or ID...",value:m,onChange:s=>oe(s.target.value),icon:e.jsx(Ce,{className:"w-4 h-4"})})}),e.jsx(re,{filters:N,onFilterChange:ie,options:ge})]})}),u.length>0&&e.jsx(Be,{selectedCount:u.length,actions:fe,onClearSelection:()=>O([])}),e.jsx(ae,{children:e.jsx(ye,{data:i||[],columns:he,selectable:!0,selectedRows:u,onSelectionChange:O,pagination:S,onPageChange:s=>D({...N,search:m,page:s}),loading:d,emptyMessage:"No leads found"})}),e.jsx(U,{isOpen:E,onClose:()=>{B(!1),L(null),y({consultantId:"",officeId:""})},title:"Assign Lead",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Student Information"}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:(X=x==null?void 0:x.student)==null?void 0:X.name}),e.jsx("p",{className:"text-sm text-gray-600",children:(Y=x==null?void 0:x.student)==null?void 0:Y.email}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Destination: ",(J=x==null?void 0:x.studyPreferences)==null?void 0:J.destination]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Office *"}),e.jsxs("select",{value:n.officeId,onChange:s=>y(l=>({...l,officeId:s.target.value,consultantId:""})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Office"}),g==null?void 0:g.map(s=>{var l;return e.jsxs("option",{value:s.id,children:[s.name," - ",(l=s.address)==null?void 0:l.city]},s.id)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Consultant *"}),e.jsxs("select",{value:n.consultantId,onChange:s=>y(l=>({...l,consultantId:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!n.officeId,children:[e.jsx("option",{value:"",children:"Select Consultant"}),(K=I==null?void 0:I.filter(s=>{var l;return(l=s.consultantOffices)==null?void 0:l.some(f=>f.id===n.officeId)}))==null?void 0:K.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.email]},s.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(j,{variant:"outline",onClick:()=>{B(!1),L(null),y({consultantId:"",officeId:""})},children:"Cancel"}),e.jsx(j,{onClick:()=>ce(x.id,n.consultantId,n.officeId),disabled:!n.consultantId||!n.officeId,children:"Assign Lead"})]})]})}),e.jsx(U,{isOpen:H,onClose:()=>{z(!1),y({consultantId:"",officeId:""})},title:`Bulk Assign ${u.length} Leads`,size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["You are about to assign ",u.length," leads to a consultant."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Office *"}),e.jsxs("select",{value:n.officeId,onChange:s=>y(l=>({...l,officeId:s.target.value,consultantId:""})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Office"}),g==null?void 0:g.map(s=>{var l;return e.jsxs("option",{value:s.id,children:[s.name," - ",(l=s.address)==null?void 0:l.city]},s.id)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Consultant *"}),e.jsxs("select",{value:n.consultantId,onChange:s=>y(l=>({...l,consultantId:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!n.officeId,children:[e.jsx("option",{value:"",children:"Select Consultant"}),(Q=I==null?void 0:I.filter(s=>{var l;return(l=s.consultantOffices)==null?void 0:l.some(f=>f.id===n.officeId)}))==null?void 0:Q.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.email]},s.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(j,{variant:"outline",onClick:()=>{z(!1),y({consultantId:"",officeId:""})},children:"Cancel"}),e.jsx(j,{onClick:de,disabled:!n.consultantId||!n.officeId,children:"Assign All Leads"})]})]})}),e.jsx(U,{isOpen:_,onClose:()=>{F(!1),L(null),W([])},title:"Lead History",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-medium",children:(Z=x==null?void 0:x.student)==null?void 0:Z.name}),e.jsx("p",{className:"text-sm text-gray-600",children:(ee=x==null?void 0:x.student)==null?void 0:ee.email})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:q.length>0?e.jsx("div",{className:"space-y-3",children:q.map((s,l)=>e.jsx("div",{className:"border-l-2 border-blue-200 pl-4 pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.action||s.note}),s.userId&&e.jsxs("p",{className:"text-sm text-gray-600",children:["by User ID: ",s.userId]})]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(s.timestamp).toLocaleString()})]})},l))}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No history available for this lead"})})]})}),w&&e.jsx("div",{className:"fixed bottom-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:w})]})};export{as as default};
