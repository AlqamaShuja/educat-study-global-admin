import{r as d,j as e,L as ue,B as c}from"./index-8BfwU0ug.js";import{u as xe}from"./consultantStore-km2Ensn4.js";import{B as K}from"./Badge-C3S8D2uw.js";import{M as I}from"./Modal-BwhwgVqM.js";import{I as M}from"./Input-1qecWYJp.js";import{C as E}from"./Card-D8yAsbgn.js";import{P as pe}from"./plus-x9Vd6qoA.js";import{S as he}from"./search-BAtyx4tz.js";import{F as ge}from"./funnel-o2b3UmUJ.js";import{U as Q}from"./user-BqCmbBnp.js";import{M as je}from"./mail-14nxtcVU.js";import{C as O}from"./calendar-CUl-7r5l.js";import{C as fe}from"./clock-BTHKTwiy.js";import{E as ye}from"./eye-DGH7ITOI.js";import{S as W}from"./square-pen-C7wA0N2U.js";import{T as be}from"./trash-2-DUEwUcLl.js";import{V as L}from"./video-C3DLgTi5.js";import{M as X}from"./map-pin-D_rU419Z.js";import"./createLucideIcon-DXfLnrkV.js";const m=(x,p="info")=>{console.log(`${p.toUpperCase()}: ${x}`),window.alert&&p==="error"?window.alert(x):console.log(`Notification: ${x}`)},Ve=()=>{var B,J,q,R,Z;const{leads:x,appointments:p=[],fetchLeads:U,scheduleMeeting:Y,updateAppointment:ee,deleteAppointment:te,fetchAppointments:g,loading:se,error:N,clearError:_}=xe(),[ae,j]=d.useState([]),[ne,v]=d.useState(!1),[le,f]=d.useState(!1),[re,w]=d.useState(!1),[s,o]=d.useState(null),[S,F]=d.useState("table"),[l,A]=d.useState({status:"",type:"",search:"",dateRange:""}),[n,y]=d.useState({studentId:"",dateTime:"",type:"in_person",notes:""}),[h,C]=d.useState(!1),k=t=>{if(!t)return"";const a=new Date(t),i=a.getTimezoneOffset()*6e4;return new Date(a.getTime()-i).toISOString().slice(0,16)},z=t=>t?new Date(t).toISOString():"";d.useEffect(()=>{U(),g().then(t=>{t&&t.length>0?j(t):V()}).catch(t=>{console.error("Failed to fetch appointments:",t),V()})},[U,g]),d.useEffect(()=>{N&&(console.error("Store error:",N),m(N,"error"),_())},[N,_]);const P=p.length>0?p:ae,V=()=>{const t=[{id:"apt-1",studentId:"e3701205-af3b-46b5-b059-a8d1bc4ff3ba",student:{id:"e3701205-af3b-46b5-b059-a8d1bc4ff3ba",name:"John Doe",email:"john@example.com",phone:"+1234567890"},dateTime:new Date(Date.now()+864e5).toISOString(),type:"virtual",status:"scheduled",notes:"Initial consultation about study abroad programs",createdAt:new Date().toISOString()},{id:"apt-2",studentId:"student-2",student:{id:"student-2",name:"Jane Smith",email:"jane@example.com",phone:"+1234567891"},dateTime:new Date(Date.now()+1728e5).toISOString(),type:"in_person",status:"scheduled",notes:"Follow-up meeting to discuss application progress",createdAt:new Date().toISOString()},{id:"apt-3",studentId:"student-3",student:{id:"student-3",name:"Mike Johnson",email:"mike@example.com",phone:"+1234567892"},dateTime:new Date(Date.now()-864e5).toISOString(),type:"virtual",status:"completed",notes:"Discussed university options and requirements",createdAt:new Date().toISOString()}];j(t)},ie=async()=>{var t;if(!n.studentId||!n.dateTime){m("Please fill in all required fields","error");return}C(!0);try{const a={dateTime:z(n.dateTime),type:n.type,notes:n.notes},i=await Y(n.studentId,a);if(p.length===0){const r={id:`apt-${Date.now()}`,studentId:n.studentId,dateTime:a.dateTime,type:n.type,notes:n.notes,student:((t=x.find(u=>{var b;return((b=u.student)==null?void 0:b.id)===n.studentId}))==null?void 0:t.student)||{id:n.studentId,name:"Unknown Student",email:"N/A"},status:"scheduled",createdAt:new Date().toISOString()};j(u=>[r,...u])}m("Appointment scheduled successfully!","success"),v(!1),T(),g().catch(()=>{console.log("Using local appointments")})}catch(a){m("Failed to schedule appointment","error"),console.error("Schedule appointment error:",a)}finally{C(!1)}},oe=async()=>{if(s){C(!0);try{const t={dateTime:typeof s.dateTime=="string"&&s.dateTime.includes("T")&&!s.dateTime.includes("Z")?z(s.dateTime):s.dateTime,type:s.type,status:s.status,notes:s.notes};try{await ee(s.id,t),m("Appointment updated successfully!","success")}catch(a){console.warn("API update failed, updating local state:",a),j(i=>i.map(r=>r.id===s.id?{...s,dateTime:t.dateTime}:r)),m("Appointment updated locally!","success")}f(!1),o(null),g().catch(()=>{console.log("Using local appointments")})}catch(t){m("Failed to update appointment","error"),console.error("Update appointment error:",t)}finally{C(!1)}}},de=async t=>{if(confirm("Are you sure you want to delete this appointment?"))try{try{await te(t),m("Appointment deleted successfully!","success")}catch(a){console.warn("API delete failed, updating local state:",a),j(i=>i.filter(r=>r.id!==t)),m("Appointment deleted locally!","success")}g().catch(()=>{console.log("Using local appointments")})}catch(a){m("Failed to delete appointment","error"),console.error("Delete appointment error:",a)}},T=()=>{y({studentId:"",dateTime:"",type:"in_person",notes:""})},$=t=>({scheduled:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800",no_show:"bg-gray-100 text-gray-800"})[t]||"bg-gray-100 text-gray-800",ce=t=>t==="virtual"?L:X,D=P.filter(t=>{var u,b,G,H;const a=!l.status||t.status===l.status,i=!l.type||t.type===l.type,r=!l.search||((b=(u=t.student)==null?void 0:u.name)==null?void 0:b.toLowerCase().includes(l.search.toLowerCase()))||((H=(G=t.student)==null?void 0:G.email)==null?void 0:H.toLowerCase().includes(l.search.toLowerCase()));return a&&i&&r}),me=x.map(t=>{var a,i,r;return{id:((a=t.student)==null?void 0:a.id)||t.studentId,name:((i=t.student)==null?void 0:i.name)||"Unknown Student",email:((r=t.student)==null?void 0:r.email)||"N/A"}});return se&&P.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ue,{size:"lg"})}):e.jsxs("div",{className:"space-y-6 p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Appointment Management"}),e.jsx("p",{className:"text-gray-600",children:"Schedule and manage student appointments"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex rounded-md shadow-sm",children:[e.jsx("button",{onClick:()=>F("table"),className:`px-4 py-2 text-sm font-medium border ${S==="table"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} rounded-l-md`,children:"Table View"}),e.jsx("button",{onClick:()=>F("calendar"),className:`px-4 py-2 text-sm font-medium border-t border-r border-b ${S==="calendar"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} rounded-r-md`,children:"Calendar View"})]}),e.jsxs(c,{onClick:()=>v(!0),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Schedule Meeting"]})]})]}),e.jsx(E,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(he,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(M,{placeholder:"Search by student name or email...",value:l.search,onChange:t=>A({...l,search:t.target.value}),className:"pl-10"})]}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:l.status,onChange:t=>A({...l,status:t.target.value}),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"no_show",children:"No Show"})]}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:l.type,onChange:t=>A({...l,type:t.target.value}),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"in_person",children:"In Person"}),e.jsx("option",{value:"virtual",children:"Virtual"})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Total: ",D.length," appointments"]})]})}),S==="table"&&e.jsx(E,{children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(t=>{var r,u;const a=new Date(t.dateTime),i=ce(t.type);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx(Q,{className:"h-6 w-6 text-gray-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((r=t.student)==null?void 0:r.name)||"N/A"}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),((u=t.student)==null?void 0:u.email)||"N/A"]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.toLocaleDateString()}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(i,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900 capitalize",children:t.type.replace("_"," ")})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(K,{className:$(t.status),children:t.status.replace("_"," ").toUpperCase()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{size:"sm",variant:"outline",onClick:()=>{o(t),w(!0)},title:"View Details",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>{o(t),f(!0)},title:"Edit Appointment",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>de(t.id),className:"text-red-600 hover:text-red-800 hover:bg-red-50",title:"Delete Appointment",children:e.jsx(be,{className:"h-4 w-4"})}),t.type==="virtual"&&t.status==="scheduled"&&e.jsxs(c,{size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"Join"]})]})})]},t.id)})})]}),D.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(O,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No appointments found"}),e.jsx("p",{className:"text-gray-500",children:l.search||l.status||l.type?"No appointments match your current filters.":"Schedule your first appointment to get started."})]})]})}),S==="calendar"&&e.jsx(E,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(O,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Calendar View"}),e.jsx("p",{className:"text-gray-500",children:"Calendar component integration needed. For now, please use table view."})]})}),e.jsx(I,{isOpen:ne,onClose:()=>{v(!1),T()},title:"Schedule New Appointment",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student *"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:n.studentId,onChange:t=>y({...n,studentId:t.target.value}),children:[e.jsx("option",{value:"",children:"Select a student..."}),me.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.email,")"]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date & Time *"}),e.jsx(M,{type:"datetime-local",value:k(n.dateTime),onChange:t=>y({...n,dateTime:t.target.value}),min:k(new Date().toISOString())})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Type"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:n.type,onChange:t=>y({...n,type:t.target.value}),children:[e.jsx("option",{value:"in_person",children:"In Person"}),e.jsx("option",{value:"virtual",children:"Virtual"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",rows:3,value:n.notes,onChange:t=>y({...n,notes:t.target.value}),placeholder:"Enter appointment notes..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(c,{variant:"outline",onClick:()=>{v(!1),T()},disabled:h,children:"Cancel"}),e.jsx(c,{onClick:ie,disabled:h||!n.studentId||!n.dateTime,children:h?"Scheduling...":"Schedule Appointment"})]})]})}),e.jsx(I,{isOpen:re,onClose:()=>{w(!1),o(null)},title:"Appointment Details",size:"lg",children:s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:((B=s.student)==null?void 0:B.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:((J=s.student)==null?void 0:J.email)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("p",{className:"text-gray-900",children:((q=s.student)==null?void 0:q.phone)||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Appointment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date & Time"}),e.jsx("p",{className:"text-gray-900",children:new Date(s.dateTime).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),e.jsxs("div",{className:"flex items-center",children:[s.type==="virtual"?e.jsx(L,{className:"h-4 w-4 mr-2 text-blue-500"}):e.jsx(X,{className:"h-4 w-4 mr-2 text-green-500"}),e.jsx("span",{className:"capitalize",children:s.type.replace("_"," ")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx(K,{className:$(s.status),children:s.status.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),e.jsx("p",{className:"text-gray-900",children:new Date(s.createdAt).toLocaleDateString()})]})]})]}),s.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:e.jsx("p",{className:"text-gray-900",children:s.notes})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(c,{variant:"outline",onClick:()=>{w(!1),o(s),f(!0)},children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx(c,{onClick:()=>{w(!1),o(null)},children:"Close"})]})]})}),e.jsx(I,{isOpen:le,onClose:()=>{f(!1),o(null)},title:"Edit Appointment",size:"lg",children:s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student"}),e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-md",children:[e.jsx(Q,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:((R=s.student)==null?void 0:R.name)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:((Z=s.student)==null?void 0:Z.email)||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date & Time"}),e.jsx(M,{type:"datetime-local",value:k(s.dateTime),onChange:t=>o({...s,dateTime:t.target.value}),min:k(new Date().toISOString())})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Type"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:s.type,onChange:t=>o({...s,type:t.target.value}),children:[e.jsx("option",{value:"in_person",children:"In Person"}),e.jsx("option",{value:"virtual",children:"Virtual"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:s.status,onChange:t=>o({...s,status:t.target.value}),children:[e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"no_show",children:"No Show"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",rows:3,value:s.notes||"",onChange:t=>o({...s,notes:t.target.value}),placeholder:"Enter appointment notes..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(c,{variant:"outline",onClick:()=>{f(!1),o(null)},disabled:h,children:"Cancel"}),e.jsx(c,{onClick:oe,disabled:h,children:h?"Updating...":"Update Appointment"})]})]})})]})};export{Ve as default};
