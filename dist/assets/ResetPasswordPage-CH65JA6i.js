import{r as i,b as Y,u as q,i as D,j as e,B as g,g as x}from"./index-D_0a8VZH.js";import{u as G}from"./index.esm-D1kEuNb-.js";import{a as H,o as U,s as S}from"./types-DPbsuHNA.js";import{I as C}from"./Input-CvXmBRSW.js";import{L as A}from"./loader-circle-CoUpajha.js";import{C as W}from"./circle-alert-C7gzbhSX.js";import{C as m}from"./circle-check-big-KsGiVaDX.js";import{L as $}from"./lock-COpwVbY9.js";import{E}from"./eye-off-CHJfUUTu.js";import{E as R}from"./eye-D1zuo86m.js";import"./createLucideIcon-QavIXzvy.js";const J=U({password:S().min(8,"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:S()}).refine(a=>a.password===a.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),K=()=>{var k,v,P;const[a,T]=i.useState(!1),[u,L]=i.useState(!1),[B,F]=i.useState(!1),[j,w]=i.useState(null),{resetPassword:I,validateResetToken:p,isLoading:l,error:b}=Y(),z=q(),[y]=D(),o=y.get("token"),c=y.get("email"),{register:N,handleSubmit:O,formState:{errors:h,isSubmitting:n},setError:f,watch:V}=G({resolver:H(J),defaultValues:{password:"",confirmPassword:""}}),s=V("password");i.useEffect(()=>{(async()=>{if(!o||!c){w(!1);return}try{const t=await p(o,c);w(t.valid)}catch{w(!1)}})()},[o,c,p]);const Z=async r=>{if(!o||!c){f("root",{message:"Invalid reset link"});return}try{const t=await I(o,c,r.password);t.success?(F(!0),setTimeout(()=>{z("/auth/login")},3e3)):f("root",{message:t.error||"Failed to reset password"})}catch{f("root",{message:"An unexpected error occurred"})}},d=(r=>{if(!r)return{strength:0,label:"",color:""};let t=0;return t=[r.length>=8,/[a-z]/.test(r),/[A-Z]/.test(r),/\d/.test(r),/[!@#$%^&*(),.?":{}|<>]/.test(r)].filter(Boolean).length,t<=2?{strength:t,label:"Weak",color:"bg-red-500"}:t<=3?{strength:t,label:"Fair",color:"bg-yellow-500"}:t<=4?{strength:t,label:"Good",color:"bg-blue-500"}:{strength:t,label:"Strong",color:"bg-green-500"}})(s);return j===null?e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8 text-center",children:[e.jsx(A,{className:"mx-auto h-8 w-8 animate-spin text-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Validating reset link..."})]})}):j===!1?e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900",children:e.jsx(W,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsx("h2",{className:"mt-6 text-2xl font-bold text-gray-900 dark:text-white",children:"Invalid Reset Link"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"This password reset link is invalid or has expired."})]}),e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsx(g,{as:x,to:"/auth/forgot-password",className:"w-full",children:"Request new reset link"}),e.jsx(g,{as:x,to:"/auth/login",variant:"outline",className:"w-full",children:"Back to sign in"})]})]})}):B?e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900",children:e.jsx(m,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"mt-6 text-2xl font-bold text-gray-900 dark:text-white",children:"Password Reset Successful"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Your password has been successfully reset."}),e.jsx("p",{className:"mt-4 text-sm text-blue-600 dark:text-blue-400",children:"Redirecting to sign in page in 3 seconds..."})]}),e.jsx("div",{className:"mt-8",children:e.jsx(g,{as:x,to:"/auth/login",className:"w-full",children:"Continue to sign in"})})]})}):e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Set new password"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Your new password must be different from previously used passwords."})]}),e.jsxs("form",{onSubmit:O(Z),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(C,{id:"password",type:a?"text":"password",placeholder:"Enter new password",className:"pl-10 pr-10",...N("password"),error:(k=h.password)==null?void 0:k.message,disabled:n||l}),e.jsx("button",{type:"button",onClick:()=>T(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",disabled:n||l,children:a?e.jsx(E,{className:"h-5 w-5"}):e.jsx(R,{className:"h-5 w-5"})})]}),s&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Password strength:"}),e.jsx("span",{className:`font-medium ${d.strength<=2?"text-red-600":d.strength<=3?"text-yellow-600":d.strength<=4?"text-blue-600":"text-green-600"}`,children:d.label})]}),e.jsx("div",{className:"mt-1 w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${d.color}`,style:{width:`${d.strength/5*100}%`}})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(C,{id:"confirmPassword",type:u?"text":"password",placeholder:"Confirm new password",className:"pl-10 pr-10",...N("confirmPassword"),error:(v=h.confirmPassword)==null?void 0:v.message,disabled:n||l}),e.jsx("button",{type:"button",onClick:()=>L(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",disabled:n||l,children:u?e.jsx(E,{className:"h-5 w-5"}):e.jsx(R,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-md p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Password must contain:"}),e.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsxs("li",{className:`flex items-center ${s&&s.length>=8?"text-green-600 dark:text-green-400":""}`,children:[e.jsx(m,{className:`mr-2 h-3 w-3 ${s&&s.length>=8?"text-green-600":"text-gray-400"}`}),"At least 8 characters"]}),e.jsxs("li",{className:`flex items-center ${s&&/[a-z]/.test(s)?"text-green-600 dark:text-green-400":""}`,children:[e.jsx(m,{className:`mr-2 h-3 w-3 ${s&&/[a-z]/.test(s)?"text-green-600":"text-gray-400"}`}),"One lowercase letter"]}),e.jsxs("li",{className:`flex items-center ${s&&/[A-Z]/.test(s)?"text-green-600 dark:text-green-400":""}`,children:[e.jsx(m,{className:`mr-2 h-3 w-3 ${s&&/[A-Z]/.test(s)?"text-green-600":"text-gray-400"}`}),"One uppercase letter"]}),e.jsxs("li",{className:`flex items-center ${s&&/\d/.test(s)?"text-green-600 dark:text-green-400":""}`,children:[e.jsx(m,{className:`mr-2 h-3 w-3 ${s&&/\d/.test(s)?"text-green-600":"text-gray-400"}`}),"One number"]})]})]}),(h.root||b)&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:((P=h.root)==null?void 0:P.message)||b})}),e.jsxs(g,{type:"submit",className:"w-full",disabled:n||l,children:[(n||l)&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Reset password"]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(x,{to:"/auth/login",className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Back to sign in"})})]})})},ce=()=>e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"A"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Admin Panel"})]})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Set new password"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Choose a strong password for your account"})]}),e.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx(K,{}),e.jsxs("div",{className:"mt-6 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Password Security Tips"}),e.jsxs("ul",{className:"space-y-1 text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("li",{children:"• Use at least 8 characters"}),e.jsx("li",{children:"• Include uppercase and lowercase letters"}),e.jsx("li",{children:"• Add numbers and special characters"}),e.jsx("li",{children:"• Avoid common words or personal information"}),e.jsx("li",{children:"• Don't reuse passwords from other accounts"})]})]})]}),e.jsx("div",{className:"mt-8 text-center text-xs text-gray-500 dark:text-gray-400",children:e.jsxs("p",{children:["Having trouble?"," ",e.jsx(x,{to:"/support",className:"text-blue-600 hover:text-blue-500 dark:text-blue-400",children:"Contact Support"})]})})]});export{ce as default};
