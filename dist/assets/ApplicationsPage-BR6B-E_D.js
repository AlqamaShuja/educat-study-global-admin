import{r as x,j as e,B as u,u as re}from"./index-D_0a8VZH.js";import{c as Y,d as H,S as I,a as U,T as J,u as ae,A as le,b as oe}from"./ApplicationsTable-DPt9mRMH.js";import{u as ie,C as K}from"./index.esm-D1kEuNb-.js";import{M as W}from"./Modal-C-TYXrEH.js";import{S as M}from"./Select-DcciDOjL.js";import{P as ne}from"./pen-line-xtmbo2wX.js";import{U as ce}from"./user-Col8Dc6N.js";import{T as A}from"./triangle-alert-ByNhgfIn.js";import{X as Q}from"./x-DZDe4kcp.js";import{S as de}from"./save-DmVXDgr0.js";import{F as _}from"./file-text-C1gJtZnp.js";import{C as $}from"./circle-check-big-KsGiVaDX.js";import{A as me}from"./award-v-MKA7uy.js";import{T as Z}from"./trending-up-Cw_lE7nU.js";import{C as ee}from"./clock-CRKKHv1b.js";import{I as xe}from"./Input-CvXmBRSW.js";import{C as S}from"./Card-BZSd9g6-.js";import{C as ue}from"./chart-column-B7YZdtT0.js";import{U as he}from"./users-8DbqKR1r.js";import{R as ge}from"./refresh-cw-DgskF8DJ.js";import{F as be}from"./funnel-WOOAs9vc.js";import{S as je}from"./search-WQZEDZzZ.js";import"./Badge-DnoA-fpa.js";import"./calendar-CFgP2NK7.js";import"./createLucideIcon-QavIXzvy.js";import"./format-CW8_DxCc.js";import"./toDate-BKXxHYqX.js";import"./building-pL6m0_IN.js";import"./mail-NeauaYI_.js";import"./globe-DqWFKqX7.js";import"./circle-x-DnT5izIu.js";import"./eye-D1zuo86m.js";import"./square-pen-DP2r3-IP.js";import"./trash-2-D-1SKTu4.js";import"./ellipsis-E4DXFL4X.js";const fe=({application:s,isOpen:h,onClose:p,onSave:l})=>{var v,w,y,C,b,T;const[g,k]=x.useState(!1),{register:q,handleSubmit:E,reset:j,watch:n,control:N,formState:{errors:r}}=ie({defaultValues:{status:"",stage:"",notes:"",rejectionReason:""}}),R=n("status");x.useEffect(()=>{s&&h&&j({status:s.status||"",stage:s.stage||"",notes:s.notes||"",rejectionReason:s.rejectionReason||""})},[s,h,j]);const c=async i=>{if(s){k(!0);try{await l(s.id,i),p()}catch(d){console.error("Failed to update application:",d)}finally{k(!1)}}},o=()=>{j(),p()},F=i=>{switch(i){case"completed":return e.jsx($,{className:"h-5 w-5 text-green-500"});case"rejected":return e.jsx(Q,{className:"h-5 w-5 text-red-500"});case"in_review":return e.jsx(ee,{className:"h-5 w-5 text-blue-500"});case"submitted":return e.jsx(Z,{className:"h-5 w-5 text-amber-500"});case"offers_received":return e.jsx(me,{className:"h-5 w-5 text-purple-500"});case"accepted":return e.jsx($,{className:"h-5 w-5 text-green-500"});default:return e.jsx(_,{className:"h-5 w-5 text-gray-500"})}};return e.jsx(W,{isOpen:h,onClose:o,title:"",size:"lg",children:e.jsxs("div",{className:"bg-white",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 via-white to-purple-50 px-6 py-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:e.jsx(ne,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Review Application"}),e.jsxs("p",{className:"text-gray-600",children:["Update status and stage for"," ",((v=s==null?void 0:s.student)==null?void 0:v.name)||"this application"]})]})]})}),e.jsxs("form",{onSubmit:E(c),className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50/30 rounded-xl p-5 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(ce,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Current Application Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Student Name"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((w=s==null?void 0:s.student)==null?void 0:w.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Application ID"}),e.jsx("p",{className:"text-xs font-mono text-gray-700 bg-gray-100 px-2 py-1 rounded",children:(s==null?void 0:s.id)||"N/A"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Current Status"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[F(s==null?void 0:s.status),e.jsx("span",{className:`text-sm font-medium ${((y=Y[s==null?void 0:s.status])==null?void 0:y.color)||"text-gray-600"}`,children:((C=Y[s==null?void 0:s.status])==null?void 0:C.label)||(s==null?void 0:s.status)||"N/A"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Current Stage"}),e.jsx("p",{className:`text-sm font-medium ${((b=H[s==null?void 0:s.stage])==null?void 0:b.color)||"text-gray-600"}`,children:((T=H[s==null?void 0:s.stage])==null?void 0:T.label)||(s==null?void 0:s.stage)||"N/A"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Application Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),console.log(I,"akcnajncasjcjsancjc"),e.jsx(K,{name:"status",control:N,rules:{required:"Status is required"},render:({field:i})=>{var d;return e.jsx(M,{options:I,value:I.find(a=>a.value===i.value),onChange:a=>i.onChange((a==null?void 0:a.value)||""),placeholder:"Choose Status",error:(d=r.status)==null?void 0:d.message,required:!0,className:"w-full"})}}),r.status&&e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[e.jsx(A,{className:"h-4 w-4 text-red-500"}),e.jsx("p",{className:"text-sm text-red-600",children:r.status.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Application Stage ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{name:"stage",control:N,rules:{required:"Stage is required"},render:({field:i})=>{var d;return e.jsx(M,{options:U,value:U.find(a=>a.value===i.value),onChange:a=>i.onChange((a==null?void 0:a.value)||""),placeholder:"Choose Stage",error:(d=r.stage)==null?void 0:d.message,required:!0,className:"w-full"})}}),r.stage&&e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[e.jsx(A,{className:"h-4 w-4 text-red-500"}),e.jsx("p",{className:"text-sm text-red-600",children:r.stage.message})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Review Notes"}),e.jsx(J,{...q("notes"),placeholder:"Add any notes, comments, or feedback about this application...",rows:4,className:"w-full border-gray-300 focus:border-blue-500 focus:ring-blue-500 resize-none !bg-white !text-black"}),e.jsx("p",{className:"text-xs text-gray-500",children:"These notes will be saved with the application for future reference."})]}),R==="rejected"&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"h-5 w-5 text-red-600"}),e.jsx("h4",{className:"font-semibold text-red-900",children:"Rejection Details Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-red-800",children:["Reason for Rejection ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(J,{...q("rejectionReason",{required:R==="rejected"?"Rejection reason is required":!1}),placeholder:"Please provide a clear reason for rejecting this application...",rows:3,className:`w-full resize-none ${r.rejectionReason?"border-red-400 focus:border-red-500 focus:ring-red-500":"border-red-300 focus:border-red-500 focus:ring-red-500"} bg-white`}),r.rejectionReason&&e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[e.jsx(A,{className:"h-4 w-4 text-red-500"}),e.jsx("p",{className:"text-sm text-red-600",children:r.rejectionReason.message})]}),e.jsx("p",{className:"text-xs text-red-700",children:"This reason will be communicated to the student and consultant."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-100",children:[e.jsxs(u,{type:"button",variant:"outline",onClick:o,disabled:g,className:"px-6 py-2 border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsx(u,{type:"submit",disabled:g,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 focus:ring-2 focus:ring-blue-500 shadow-lg hover:shadow-xl transition-all duration-200",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})]})})},es=()=>{re();const{applications:s,loading:h,error:p,filters:l,fetchConsultantApplications:g,reviewApplication:k,updateApplicationStatus:q,deleteApplication:E,setFilters:j}=ae(),[n,N]=x.useState(""),[r,R]=x.useState(!1),[c,o]=x.useState(null),[F,v]=x.useState(!1),[w,y]=x.useState(!1),[C,b]=x.useState(!1);x.useEffect(()=>{g()},[g]);const T=t=>{o(t),v(!0)},i=t=>{o(t),y(!0)},d=t=>{o(t),b(!0)},a=async()=>{if(c)try{await E(c.id),b(!1),o(null)}catch(t){console.error("Failed to delete application:",t)}},z=async(t,m)=>{try{await k(t,m)}catch(L){console.error("Failed to review application:",L)}},P=(t,m)=>{j({[t]:m})},O=()=>{j({status:"",stage:""}),N("")},D=s.filter(t=>{var G,B,V,X;const m=n===""||((B=(G=t.student)==null?void 0:G.name)==null?void 0:B.toLowerCase().includes(n.toLowerCase()))||((X=(V=t.student)==null?void 0:V.email)==null?void 0:X.toLowerCase().includes(n.toLowerCase()))||t.id.toLowerCase().includes(n.toLowerCase()),L=!l.status||t.status===l.status,te=!l.stage||t.stage===l.stage;return m&&L&&te}),f=t=>s.filter(m=>m.status===t).length,se=[{label:"Draft",count:f("draft"),color:"from-gray-50 to-gray-100",textColor:"text-gray-700",icon:_,iconColor:"text-gray-500"},{label:"In Review",count:f("in_review"),color:"from-blue-50 to-blue-100",textColor:"text-blue-700",icon:ee,iconColor:"text-blue-500"},{label:"Submitted",count:f("submitted"),color:"from-yellow-50 to-yellow-100",textColor:"text-yellow-700",icon:Z,iconColor:"text-yellow-500"},{label:"Offers Received",count:f("offers_received"),color:"from-purple-50 to-purple-100",textColor:"text-purple-700",icon:ue,iconColor:"text-purple-500"},{label:"Accepted",count:f("accepted"),color:"from-green-50 to-green-100",textColor:"text-green-700",icon:$,iconColor:"text-green-500"},{label:"Completed",count:f("completed"),color:"from-teal-50 to-teal-100",textColor:"text-teal-700",icon:he,iconColor:"text-teal-500"}];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50/30",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-purple-600/10 rounded-2xl"}),e.jsx("div",{className:"relative bg-white/80 backdrop-blur-sm rounded-2xl border border-white/50 shadow-lg p-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"My Applications"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Review and update applications assigned to you by the system administrator"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(u,{variant:"outline",onClick:()=>g(),disabled:h,className:"border-blue-200 text-blue-600 hover:bg-blue-50 transition-all duration-200",children:[e.jsx(ge,{className:`h-4 w-4 mr-2 ${h?"animate-spin":""}`}),"Refresh"]})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6",children:se.map(t=>{const m=t.icon;return e.jsx(S,{className:"group hover:shadow-xl transition-all duration-300 border-0 overflow-hidden",children:e.jsxs("div",{className:`h-full bg-gradient-to-br ${t.color} p-6 relative`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`p-3 rounded-xl bg-white/50 ${t.iconColor} group-hover:scale-110 transition-transform duration-200`,children:e.jsx(m,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t.label}),e.jsx("p",{className:`text-3xl font-bold ${t.textColor}`,children:t.count})]})]})]})},t.label)})}),e.jsx(S,{className:"border-0 shadow-xl bg-white/90 backdrop-blur-sm overflow-hidden",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50/50 to-purple-50/50 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Applications Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:[D.length," application",D.length!==1?"s":""," found"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>R(!r),className:`transition-all duration-200 ${r?"bg-blue-100 border-blue-300 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Filters"]}),e.jsx(u,{variant:"outline",size:"sm",onClick:O,className:"border-purple-300 text-purple-700 hover:bg-purple-50 transition-all duration-200",children:"Clear All"})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative group",children:[e.jsx(je,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),e.jsx(xe,{placeholder:"Search applications by student name, email, or ID...",value:n,onChange:t=>N(t.target.value),className:"pl-12 py-4 text-lg border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/70 backdrop-blur-sm shadow-lg"})]})}),r&&e.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl border border-white/50 p-6 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Status Filter"}),e.jsxs(M,{value:l.status,onChange:t=>P("status",t.target.value),className:"w-full rounded-lg border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white shadow-sm",children:[e.jsx("option",{value:"",children:"All Statuses"}),I.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Stage Filter"}),e.jsxs(M,{value:l.stage,onChange:t=>P("stage",t.target.value),className:"w-full rounded-lg border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white shadow-sm",children:[e.jsx("option",{value:"",children:"All Stages"}),U.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(u,{variant:"outline",onClick:O,className:"w-full py-3 border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg transition-all duration-200",children:"Clear Filters"})})]})})]})}),e.jsx(S,{className:"border-0 shadow-xl bg-white/90 backdrop-blur-sm overflow-hidden",children:e.jsx(le,{applications:D,loading:h,onView:T,onEdit:i,onDelete:d,onReview:z,showConsultant:!1,showActions:!0,showDelete:!1})}),p&&e.jsx(S,{className:"border-0 shadow-xl overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 border-l-4 border-red-400",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-full mr-4",children:e.jsx(A,{className:"h-6 w-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-red-800 mb-1",children:"Error Occurred"}),e.jsx("p",{className:"text-red-700",children:p})]})]})})})}),!h&&D.length===0&&e.jsx(S,{className:"border-0 shadow-xl bg-white/90 backdrop-blur-sm overflow-hidden",children:e.jsxs("div",{className:"text-center py-16 px-8",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(_,{className:"h-12 w-12 text-blue-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No applications found"}),e.jsx("p",{className:"text-gray-600 mb-8 text-lg max-w-md mx-auto",children:n||l.status||l.stage?"No applications match your current filters. Try adjusting your search criteria.":"You don't have any applications assigned yet. Applications will be assigned to you by the system administrator."}),n||l.status||l.stage?e.jsx(u,{variant:"outline",onClick:O,className:"border-blue-300 text-blue-700 hover:bg-blue-50 px-8 py-3 rounded-xl transition-all duration-200",children:"Clear Filters"}):e.jsx("div",{className:"text-gray-500 text-sm",children:"Applications will be assigned to you by the system administrator."})]})}),F&&c&&e.jsx(oe,{application:c,isOpen:F,onClose:()=>{v(!1),o(null)}}),w&&c&&e.jsx(fe,{application:c,isOpen:w,onClose:()=>{y(!1),o(null)},onSave:z}),C&&c&&e.jsx(W,{isOpen:C,onClose:()=>{b(!1),o(null)},title:"Delete Application",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"Are you sure you want to delete this application? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(u,{variant:"outline",onClick:()=>{b(!1),o(null)},children:"Cancel"}),e.jsx(u,{variant:"destructive",onClick:a,children:"Delete"})]})]})})]})})};export{es as default};
