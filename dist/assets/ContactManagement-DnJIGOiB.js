import{r as d,j as e,L as I,B as h}from"./index-8BfwU0ug.js";import{u as q}from"./useApi-CYPgFTKK.js";import{u as _}from"./useAuth-DcN1mZj1.js";import{u as G,T as R}from"./Toast-BgXBk8cG.js";import{v as c,g as Y}from"./validators-DJSRcNcx.js";import{C as M}from"./Card-D8yAsbgn.js";import{B as P}from"./Badge-C3S8D2uw.js";import{I as v}from"./Input-1qecWYJp.js";import{D as H}from"./DataTable-B3HSgOB5.js";import{M as J}from"./Modal-BwhwgVqM.js";import{S as K}from"./shield-BJLPrUaL.js";import{P as F}from"./plus-x9Vd6qoA.js";import{S as Q}from"./search-BAtyx4tz.js";import{c as V}from"./createLucideIcon-DXfLnrkV.js";import{U as W}from"./user-BqCmbBnp.js";import{M as X}from"./mail-14nxtcVU.js";import{P as Z}from"./phone-DUm5NSty.js";import{S as ee}from"./square-pen-C7wA0N2U.js";import{T as se}from"./trash-2-DUEwUcLl.js";import"./userService-BNNDWOI3.js";import"./leadService-Cew0x-1D.js";import"./officeService-YCa5sj2e.js";import"./universityService-B9Qwd0nV.js";import"./courseService-IKGP0jCT.js";import"./messageService-CyNia2sF.js";import"./reportService-B_mrla-p.js";import"./Select-0k3J7if3.js";/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M16 2v2",key:"scm5qe"}],["path",{d:"M7 22v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2",key:"1waht3"}],["path",{d:"M8 2v2",key:"pbkmx"}],["circle",{cx:"12",cy:"11",r:"3",key:"itu57m"}],["rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",key:"12vinp"}]],ae=V("contact",te),Pe=()=>{const{user:S}=_(),{callApi:g,loading:L,error:N}=q(),{hasPermission:m}=G(),[E,y]=d.useState([]),[l,w]=d.useState({search:"",type:"",status:""}),[x,u]=d.useState({show:!1,mode:"add",contact:null}),[r,A]=d.useState({}),[f,i]=d.useState({show:!1,message:"",type:"success"}),[a,n]=d.useState({name:"",email:"",phone:"",type:"client",status:"contact",notes:""}),b=[{value:"client",label:"Client",color:"bg-blue-100 text-blue-800"},{value:"prospect",label:"Prospect",color:"bg-yellow-100 text-yellow-800"}],j=[{value:"active",label:"Active",color:"bg-green-100 text-green-800"},{value:"inactive",label:"Inactive",color:"bg-red-100 text-red-800"},{value:"contact",label:"Contact",color:"bg-blue-100 text-blue-800"}];d.useEffect(()=>{S&&m("manage","contacts")&&z()},[S]);const z=async()=>{try{const s=await g("GET","/receptionist/contacts");y((s==null?void 0:s.map(t=>({id:t.id,name:c(t.name||"Unknown"),email:c(t.email||"N/A"),phone:c(t.phone||"N/A"),type:t.type,status:t.status,notes:c(t.notes||"")})))||[])}catch{i({show:!0,message:N||"Failed to fetch contacts",type:"error"})}},D=async()=>{const s=Y(a);if(Object.keys(s).length){A(s);return}try{const t={...a,name:c(a.name),email:c(a.email),phone:c(a.phone),notes:c(a.notes)};if(x.mode==="add"){const o=await g("POST","/receptionist/contacts",t);y(p=>[...p,o]),i({show:!0,message:"Contact added successfully!",type:"success"})}else{const o=await g("PUT",`/receptionist/contacts/${x.contact.id}`,t);y(p=>p.map(T=>T.id===o.id?o:T)),i({show:!0,message:"Contact updated successfully!",type:"success"})}u({show:!1,mode:"add",contact:null}),C()}catch{i({show:!0,message:N||"Failed to save contact",type:"error"})}},O=async s=>{if(window.confirm("Are you sure you want to delete this contact?"))try{await g("DELETE",`/receptionist/contacts/${s}`),y(t=>t.filter(o=>o.id!==s)),i({show:!0,message:"Contact deleted successfully!",type:"success"})}catch{i({show:!0,message:N||"Failed to delete contact",type:"error"})}},C=()=>{n({name:"",email:"",phone:"",type:"client",status:"contact",notes:""}),A({})},k=E.filter(s=>{const t=!l.search||s.name.toLowerCase().includes(l.search.toLowerCase())||s.email.toLowerCase().includes(l.search.toLowerCase())||s.phone.includes(l.search),o=!l.type||s.type===l.type,p=!l.status||s.status===l.status;return t&&o&&p}),U=s=>{var t;return((t=b.find(o=>o.value===s))==null?void 0:t.color)||"bg-gray-100 text-gray-800"},$=s=>{var t;return((t=j.find(o=>o.value===s))==null?void 0:t.color)||"bg-gray-100 text-gray-800"},B=[{key:"name",label:"Name",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm",children:s.name})]})},{key:"email",label:"Email",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(X,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm",children:s.email})]})},{key:"phone",label:"Phone",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm",children:s.phone})]})},{key:"type",label:"Type",render:s=>{var t;return e.jsx(P,{className:U(s.type),children:(t=b.find(o=>o.value===s.type))==null?void 0:t.label})}},{key:"status",label:"Status",render:s=>{var t;return e.jsx(P,{className:$(s.status),children:(t=j.find(o=>o.value===s.status))==null?void 0:t.label})}},{key:"notes",label:"Notes",render:s=>e.jsx("span",{className:"text-sm",children:s.notes||"N/A"})},{key:"actions",label:"Actions",render:s=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(h,{size:"sm",variant:"outline",onClick:()=>{u({show:!0,mode:"edit",contact:s}),n({name:s.name,email:s.email,phone:s.phone,type:s.type,status:s.status,notes:s.notes})},disabled:!m("edit","contacts"),children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(h,{size:"sm",variant:"outline",onClick:()=>O(s.id),className:"border-red-300 text-red-600 hover:bg-red-50",disabled:!m("delete","contacts"),children:e.jsx(se,{className:"h-4 w-4"})})]})}];return L?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(I,{size:"lg"})}):m("manage","contacts")?e.jsxs("div",{className:"space-y-6",children:[e.jsx(R,{isOpen:f.show,message:f.message,type:f.type,onClose:()=>i({...f,show:!1})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage client and prospect contact information."})]}),e.jsxs(h,{onClick:()=>u({show:!0,mode:"add",contact:null}),disabled:!m("create","contacts"),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add Contact"]})]}),e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(v,{placeholder:"Search by name, email or phone...",value:l.search,onChange:s=>w({...l,search:s.target.value}),className:"pl-10"})]}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:l.type,onChange:s=>w({...l,type:s.target.value}),children:[e.jsx("option",{value:"",children:"All Types"}),b.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:l.status,onChange:s=>w({...l,status:s.target.value}),children:[e.jsx("option",{value:"",children:"All Statuses"}),j.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[k.length," of ",E.length," contacts"]})]})}),e.jsxs(M,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Contacts"}),k.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ae,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No contacts found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:Object.values(l).some(s=>s)?"No contacts match your current filters.":"Add your first contact to get started."}),e.jsxs(h,{onClick:()=>u({show:!0,mode:"add",contact:null}),disabled:!m("create","contacts"),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add First Contact"]})]}):e.jsx(H,{data:k,columns:B,pagination:!0,pageSize:10})]}),e.jsx(J,{isOpen:x.show,onClose:()=>{u({show:!1,mode:"add",contact:null}),C()},title:x.mode==="add"?"Add Contact":"Edit Contact",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),e.jsx(v,{value:a.name,onChange:s=>n({...a,name:s.target.value}),placeholder:"Enter contact name",className:r.name?"border-red-500":""}),r.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx(v,{type:"email",value:a.email,onChange:s=>n({...a,email:s.target.value}),placeholder:"Enter contact email",className:r.email?"border-red-500":""}),r.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx(v,{type:"tel",value:a.phone,onChange:s=>n({...a,phone:s.target.value}),placeholder:"Enter contact phone",className:r.phone?"border-red-500":""}),r.phone&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type *"}),e.jsx("select",{className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${r.type?"border-red-500":""}`,value:a.type,onChange:s=>n({...a,type:s.target.value}),children:b.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),r.type&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),e.jsx("select",{className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${r.status?"border-red-500":""}`,value:a.status,onChange:s=>n({...a,status:s.target.value}),children:j.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),r.status&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",rows:3,value:a.notes,onChange:s=>n({...a,notes:s.target.value}),placeholder:"Enter any additional notes..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(h,{variant:"outline",onClick:()=>{u({show:!1,mode:"add",contact:null}),C()},children:"Cancel"}),e.jsx(h,{onClick:D,children:x.mode==="add"?"Add Contact":"Update Contact"})]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(K,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You do not have permission to manage contacts."})]})};export{Pe as default};
